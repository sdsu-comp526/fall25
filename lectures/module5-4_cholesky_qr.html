
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>19) Cholesky QR &#8212; Computational Methods for Scientists Fall 25</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lectures/module5-4_cholesky_qr';</script>
    <link rel="icon" href="../_static/SDSU-comp526_logo.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="20) Solving Systems" href="module5-5_solving_systems.html" />
    <link rel="prev" title="18) Householder QR" href="module5-3_householder.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/SDSU-comp526_logo.svg" class="logo__image only-light" alt="Computational Methods for Scientists Fall 25 - Home"/>
    <script>document.write(`<img src="../_static/SDSU-comp526_logo.svg" class="logo__image only-dark" alt="Computational Methods for Scientists Fall 25 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../syllabus.html">Syllabus</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../lectures.html">Lectures</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="module1-1_first_class.html">1) First Class: Reproducibility and Git</a></li>


<li class="toctree-l2"><a class="reference internal" href="module1-2_linux.html">2) The Linux Filesystem and commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="module1-3_community_projects.html">3) Community Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="module2-1_intro_to_fortran.html">4) Introduction to Fortran</a></li>
<li class="toctree-l2"><a class="reference internal" href="module3-1_functions_and_fpa.html">5) Functions</a></li>



<li class="toctree-l2"><a class="reference internal" href="module3-2_function_errors.html">6) Function errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="module3-3_conditioning.html">7) Conditioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="module3-4_root_finding.html">8) Rootfinding</a></li>
<li class="toctree-l2"><a class="reference internal" href="module3-5_convergence_classes.html">9) Convergence classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="module3-6_newton.html">10) Newton methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="module3-7_stability.html">11) Stability</a></li>
<li class="toctree-l2"><a class="reference internal" href="module4-1_intro_to_c.html">12) Intro to C</a></li>
<li class="toctree-l2"><a class="reference internal" href="module4-2_c_pointers.html">13) Intro to C pointers</a></li>
<li class="toctree-l2"><a class="reference internal" href="module4-3_c_structs_and_functions.html">14) C structs and functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="module4-4_c_memory.html">15) C memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="module5-1_linear_algebra.html">16) Linear Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="module5-2_gram_schmidt.html">17) Gram-Schmidt and QR</a></li>
<li class="toctree-l2"><a class="reference internal" href="module5-3_householder.html">18) Householder QR</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">19) Cholesky QR</a></li>
<li class="toctree-l2"><a class="reference internal" href="module5-5_solving_systems.html">20) Solving Systems</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/sdsu-comp526/fall25" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/sdsu-comp526/fall25/issues/new?title=Issue%20on%20page%20%2Flectures/module5-4_cholesky_qr.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/lectures/module5-4_cholesky_qr.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>19) Cholesky QR</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#last-time">Last time</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#today">Today</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-on-householder-qr">1. Recap on Householder QR</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#householder-an-improved-algorithm">Householder: An improved algorithm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#householder-is-backward-stable">Householder is backward stable</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#orthogonality-is-preserved">Orthogonality is preserved</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#composition-of-reflectors">2. Composition of reflectors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#this-works-even-for-very-nonsquare-matrices">This works even for very nonsquare matrices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-to-python-s-numpy-linalg-qr">Compare to Python’s <code class="docutils literal notranslate"><span class="pre">numpy.linalg.qr</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cholesky-decomposition">3. Cholesky decomposition</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#can-we-fix-this">Can we fix this?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-fast-are-these-methods">How fast are these methods?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#profiling">4. Profiling</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="cholesky-qr">
<h1>19) Cholesky QR<a class="headerlink" href="#cholesky-qr" title="Link to this heading">#</a></h1>
<section id="last-time">
<h2>Last time<a class="headerlink" href="#last-time" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Householder QR</p></li>
</ul>
</section>
<section id="today">
<h2>Today<a class="headerlink" href="#today" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Recap on Householder QR</p></li>
<li><p>Composition of reflectors</p></li>
<li><p>Cholesky Decomposition</p></li>
<li><p>Profiling</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">LinearAlgebra</span>
<span class="k">using</span><span class="w"> </span><span class="n">Plots</span>
<span class="n">default</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">legendfontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="k">function</span><span class="w"> </span><span class="n">vander</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="nb">nothing</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">isnothing</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="w">        </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="n">V</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ones</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="n">k</span>
<span class="w">        </span><span class="n">V</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">V</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="n">x</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">V</span>
<span class="k">end</span>

<span class="k">function</span><span class="w"> </span><span class="n">gram_schmidt_classical</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">    </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">    </span><span class="n">Q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">        </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
<span class="w">        </span><span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Q</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="o">:</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v</span>
<span class="w">        </span><span class="n">v</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">Q</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="o">:</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
<span class="w">        </span><span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="w">        </span><span class="n">Q</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold -Color-Bold-Yellow">┌ Warning: </span>Circular dependency detected.
<span class=" -Color -Color-Bold -Color-Bold-Yellow">│ </span>Precompilation will be skipped for dependencies in this cycle:
<span class=" -Color -Color-Bold -Color-Bold-Yellow">│ </span> ┌ Symbolics → SymbolicsForwardDiffExt
<span class=" -Color -Color-Bold -Color-Bold-Yellow">│ </span> └─ Symbolics → SymbolicsPreallocationToolsExt
<span class=" -Color -Color-Bold -Color-Bold-Yellow">└ </span>@ Pkg.API.Precompilation ~/julia-1.10.9/share/julia/stdlib/v1.10/Pkg/src/precompilation.jl:583
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold -Color-Bold-Green">Precompiling</span> packages...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    381.5 ms<span class=" -Color -Color-Green">  ✓ </span>Qt6ShaderTools_jll
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    751.7 ms<span class=" -Color -Color-Green">  ✓ </span>Qt6Declarative_jll
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    375.1 ms<span class=" -Color -Color-Green">  ✓ </span>Qt6Wayland_jll
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   1465.4 ms<span class=" -Color -Color-Green">  ✓ </span>Plots → UnitfulExt
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   1168.4 ms<span class=" -Color -Color-Green">  ✓ </span>Plots → IJuliaExt
  5 dependencies successfully precompiled in 4 seconds. 151 already precompiled. 2 skipped due to circular dependency.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gram_schmidt_classical (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">reflectors_mult</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="w">        </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="n">y</span><span class="p">[</span><span class="k">end</span><span class="o">-</span><span class="n">n</span><span class="o">:</span><span class="n">end</span><span class="p">]</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="o">&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="k">end</span><span class="o">-</span><span class="n">n</span><span class="o">:</span><span class="n">end</span><span class="p">])</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">y</span>
<span class="k">end</span>

<span class="k">function</span><span class="w"> </span><span class="n">reflectors_to_dense</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="w">    </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="w">    </span><span class="n">Q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">diagm</span><span class="p">(</span><span class="n">ones</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">        </span><span class="n">Q</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reflectors_mult</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="w"> </span><span class="n">Q</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">Q</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>reflectors_to_dense (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
<p><img alt="Choosing the better of two Householder reflectors (Trefethen and Bau, 1999)." src="../_images/TB-Householder2reflectors.png" /></p>
</section>
<section id="recap-on-householder-qr">
<h2>1. Recap on Householder QR<a class="headerlink" href="#recap-on-householder-qr" title="Link to this heading">#</a></h2>
<section id="householder-an-improved-algorithm">
<h3>Householder: An improved algorithm<a class="headerlink" href="#householder-an-improved-algorithm" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">qr_householder</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">    </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">    </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">    </span><span class="n">V</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="c"># list of reflectors</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">        </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="o">:</span><span class="n">end</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">])</span>
<span class="w">        </span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">sign</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="c"># &lt;--- here we pick the sign of v so that moves it the largest distance</span>
<span class="w">        </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">normalize</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="w">        </span><span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="o">:</span><span class="n">end</span><span class="p">,</span><span class="n">j</span><span class="o">:</span><span class="n">end</span><span class="p">]</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v</span><span class="o">&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="o">:</span><span class="n">end</span><span class="p">,</span><span class="n">j</span><span class="o">:</span><span class="n">end</span><span class="p">]</span>
<span class="w">        </span><span class="n">push!</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">V</span><span class="p">,</span><span class="w"> </span><span class="n">R</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>qr_householder (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span>
<span class="n">V</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qr_householder</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">V</span><span class="p">]</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">tau</span>
<span class="n">V1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">v</span><span class="w"> </span><span class="o">./</span><span class="w"> </span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">V</span><span class="p">]</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">V1</span>
<span class="n">R</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tau = [2.0, 2.0]
V1 = 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1.0, 0.0], [1.0]]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2×2 Matrix{Int64}:
 -1   0
  0  -1
</pre></div>
</div>
</div>
</div>
</section>
<section id="householder-is-backward-stable">
<h3>Householder is backward stable<a class="headerlink" href="#householder-is-backward-stable" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">40</span>
<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">LinRange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">)</span>
<span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vander</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">)</span>
<span class="n">V</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qr_householder</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">Q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reflectors_to_dense</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">Q</span><span class="o">&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Q</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">I</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">Q</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>norm(Q&#39; * Q - I) = 5.949301496893686e-15
norm(Q * R - A) = 1.2090264267288813e-14
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mf">1.</span><span class="p">]</span>
<span class="n">V</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qr_householder</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="w">  </span><span class="c"># we don&#39;t get NaNs anymore</span>
<span class="n">qr</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="w"> </span><span class="c"># Julia built-in</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LinearAlgebra.QRCompactWY{Float64, Matrix{Float64}, Matrix{Float64}}
Q factor: 2×2 LinearAlgebra.QRCompactWYQ{Float64, Matrix{Float64}, Matrix{Float64}}
R factor:
2×2 Matrix{Float64}:
 1.0  0.0
 0.0  1.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="orthogonality-is-preserved">
<h3>Orthogonality is preserved<a class="headerlink" href="#orthogonality-is-preserved" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">LinRange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span>
<span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vander</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="c"># [1 | x | x^2 | ... x^19]</span>
<span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gram_schmidt_classical</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">Q</span><span class="o">&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Q</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">I</span><span class="p">)</span>
<span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="k">end</span><span class="p">]</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="n">scatter</span><span class="p">(</span><span class="n">abs</span><span class="o">.</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v</span><span class="p">),</span><span class="w"> </span><span class="n">yscale</span><span class="o">=</span><span class="ss">:log10</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Classical Gram-Schmidt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>norm(Q&#39; * Q - I) = 1.4985231287367549
norm(v) = 1.4245900685395503
</pre></div>
</div>
<div class="output text_html"><img src="data:image/png;base64,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w4cPz8jImD59+ieffFJSUhIWFhYfH79q1Soulztz5sycnJzaw3h7exNClixZcvHiRYVCUcuUM2fOXLJkib29/d9///3w4cPExMT9+/cHBARIJBLVyaZOnSoSicLCwhISEjZv3mxqarpy5cqLFy+qze3HH39MS0s7fPhwQkLCunXr9PX1v/rqqzVr1sydO3fx4sUxMTFnzpzx9PSMiIig97++SlRU1MSJE7lc7ubNm58+fZqQkNClS5fhw4erTrN8+XL6z5oxY8Zc+E/Pnj1r/2RAJzHdxNDYDB06lNT5gMy6HDWakZFhZGTUunVr5UhISAghJDMz81UvsbKysra2rmWeamuECoXCw8ODELJnz566xFaaOnUqISQ0NFQ5Upc1QnpL76VLl+r4LvQaISFkw4YNr524oqLCyclJIBAIhULloLm5OSHkyy+/VI6IxWJ67bB58+aqU3722WeEkC1bttT+LoWFhcptkpaWloMGDVq2bFlSUpLaZDExMYQQOzu7vLy8V82KXiP09PRU3YRAH24zffp05Qi9RmhjY1NWVqYcVPb98ePHlYP0dmBfX1/lSM01woCAAELI7t27lSNyubxLly7kxaNG9+zZQwj54Ycfav80QNdhjRA0rLy8nBBiYmKiqRm6uLh4eXk9fPiwoqKCHqF/rdMbsl7KzMysoqIiOTm5jm9x+/btlJQUDw+PsWPHvlG2wYMHE0JiY2Pf6FX0gqh9RPn5+SEvUvYfzcLC4tNPP33tzE1MTHr27CkUCmsu/tdff638Wl9fv2vXroSQ6dOnq+7n6969OyHkyZMntb+LlZVVYmLi/PnzXVxciouL//nnn/nz57dv397T01P1+7J//35CyKxZs9T2xdb01VdfqW5CoDdL1owxefJk1dMN6bRubm70N4Lm5eVlZmZWyyIUFhZeu3bN3t7+448/Vg5yudzZs2fXHhIaKxwsAxrWpEkTQohQKHy7l8tksq1btx44cIA++kMmkymfKi4upveHTZw4MTQ0dNSoUatXr+7Tp09QUJC/v7+e3v9/mCdNmrRgwYIOHToEBwf36tUrODi49jOp79y5Q/7b3FeLlJSUFStWxMXFPXv2rLKyUjleVFT0RstobGxcUVGh9hGJxWLlERmVlZUymay0tFR1glatWqmdcUg7fPjw9u3bHz58mJubq7q9US2VoaGh2qEi1tbW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" /></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reflectors_to_dense</span><span class="p">(</span><span class="n">qr_householder</span><span class="p">(</span><span class="n">A</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">Q</span><span class="o">&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Q</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">I</span><span class="p">)</span>
<span class="n">scatter</span><span class="p">(</span><span class="n">abs</span><span class="o">.</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v</span><span class="p">),</span><span class="w"> </span><span class="n">yscale</span><span class="o">=</span><span class="ss">:log10</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Householder QR&quot;</span><span class="p">)</span><span class="w"> </span><span class="c"># they are less linearly dependent, i.e., more linearly independent</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>norm(Q&#39; * Q - I) = 3.840520021608235e-15
</pre></div>
</div>
<div class="output text_html"><img src="data:image/png;base64,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" /></div></div>
</div>
</section>
<section id="summary">
<h3>Summary:<a class="headerlink" href="#summary" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Classic Gram-Schmidt: Usually very poor orthogonality.</p></li>
<li><p>Modified Gram-Schmidt: Depends upon condition of <span class="math notranslate nohighlight">\(A\)</span>. Fails completely when <span class="math notranslate nohighlight">\(A\)</span> is singular.</p></li>
<li><p>Householder triangularization: Always good orthogonality and backward stable.</p></li>
</ul>
</section>
</section>
<section id="composition-of-reflectors">
<h2>2. Composition of reflectors<a class="headerlink" href="#composition-of-reflectors" title="Link to this heading">#</a></h2>
<div class="amsmath math notranslate nohighlight" id="equation-d21740aa-05a4-4f8a-a529-ef175bfae3d7">
<span class="eqno">(7)<a class="headerlink" href="#equation-d21740aa-05a4-4f8a-a529-ef175bfae3d7" title="Permalink to this equation">#</a></span>\[\begin{align}
(I - 2 v v^T) (I - 2 w w^T) &amp;= I - 2 v v^T - 2 w w^T + 4 v (v^T w) w^T \\
&amp;= I - \Bigg[v \Bigg| w \Bigg] \begin{bmatrix} 2 &amp; -4 v^T w \\ 0 &amp; 2 \end{bmatrix} \begin{bmatrix} v^T \\ w^T \end{bmatrix}
\end{align}\]</div>
<p>This turns applying reflectors from a sequence of vector operations to a sequence of (smallish) matrix operations. It’s the key to high performance and the native format (<a class="reference external" href="https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/#LinearAlgebra.QRCompactWY"><code class="docutils literal notranslate"><span class="pre">QRCompactWY</span></code></a>) returned by Julia <code class="docutils literal notranslate"><span class="pre">qr()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qr</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="w"> </span><span class="c"># Julia built-in</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LinearAlgebra.QRCompactWY{Float64, Matrix{Float64}, Matrix{Float64}}
Q factor: 20×20 LinearAlgebra.QRCompactWYQ{Float64, Matrix{Float64}, Matrix{Float64}}
R factor:
20×20 Matrix{Float64}:
 -4.47214  0.0      -1.64763       0.0          …  -0.514468      2.22045e-16
  0.0      2.71448   1.11022e-16   1.79412         -2.498e-16     0.823354
  0.0      0.0      -1.46813       5.55112e-17     -0.944961     -2.23779e-16
  0.0      0.0       0.0          -0.774796         3.83808e-17  -0.913056
  0.0      0.0       0.0           0.0              0.797217     -4.06264e-16
  0.0      0.0       0.0           0.0          …  -3.59496e-16   0.637796
  0.0      0.0       0.0           0.0             -0.455484     -1.3936e-15
  0.0      0.0       0.0           0.0              4.40958e-16  -0.313652
  0.0      0.0       0.0           0.0             -0.183132      1.64685e-15
  0.0      0.0       0.0           0.0              4.82253e-16   0.109523
  0.0      0.0       0.0           0.0          …   0.0510878     5.9848e-16
  0.0      0.0       0.0           0.0             -2.68709e-15   0.0264553
  0.0      0.0       0.0           0.0             -0.0094344    -2.94383e-15
  0.0      0.0       0.0           0.0              2.08514e-15   0.00417208
  0.0      0.0       0.0           0.0              0.0010525    -2.24994e-15
  0.0      0.0       0.0           0.0          …  -1.64363e-15  -0.000385264
  0.0      0.0       0.0           0.0             -5.9057e-5     7.69025e-16
  0.0      0.0       0.0           0.0              1.76642e-16  -1.66202e-5
  0.0      0.0       0.0           0.0             -1.04299e-6   -1.68771e-16
  0.0      0.0       0.0           0.0              0.0           1.71467e-7
</pre></div>
</div>
</div>
</div>
<section id="this-works-even-for-very-nonsquare-matrices">
<h3>This works even for very nonsquare matrices<a class="headerlink" href="#this-works-even-for-very-nonsquare-matrices" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">(</span><span class="mi">1000000</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qr</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span><span class="w"> </span><span class="c"># this would show you the QRCompactWY format</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="kt">Matrix</span><span class="p">(</span><span class="n">Q</span><span class="p">))</span><span class="w"> </span><span class="c"># this shows you the actual size of Q, in standard matrix format</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">Q</span><span class="o">*</span><span class="n">R</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">A</span><span class="p">)</span>
<span class="n">R</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>size(Q) = (1000000, 1000000)
size(Matrix(Q)) = (1000000, 5)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>norm(Q * R - A) = 1.0446588626486593e-12
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5×5 Matrix{Float64}:
 -577.278  -432.657  -432.792  -432.742  -433.018
    0.0    -381.624  -163.66   -163.1    -163.226
    0.0       0.0    -344.837  -103.739  -103.643
    0.0       0.0       0.0    -329.031   -76.28
    0.0       0.0       0.0       0.0     320.171
</pre></div>
</div>
</div>
</div>
<p>This is known as a “full” (or “complete”) QR factorization, in contrast to a reduced QR factorization in which <span class="math notranslate nohighlight">\(Q\)</span> has the same shape as <span class="math notranslate nohighlight">\(A\)</span>.</p>
<ul class="simple">
<li><p>How much memory does <span class="math notranslate nohighlight">\(Q\)</span> use?</p></li>
</ul>
</section>
<section id="compare-to-python-s-numpy-linalg-qr">
<h3>Compare to Python’s <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.linalg.qr.html"><code class="docutils literal notranslate"><span class="pre">numpy.linalg.qr</span></code></a><a class="headerlink" href="#compare-to-python-s-numpy-linalg-qr" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Need to decide up-front whether you want full or reduced QR.</p></li>
<li><p>Full QR is expensive to represent.</p></li>
</ul>
</section>
</section>
<section id="cholesky-decomposition">
<h2>3. Cholesky decomposition<a class="headerlink" href="#cholesky-decomposition" title="Link to this heading">#</a></h2>
<p>First some definitions:</p>
<p>A matrix <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{n \times n}\)</span> is <em>symmetric</em> if <span class="math notranslate nohighlight">\(A = A^{T}\)</span> and <em>positive definite</em> if <span class="math notranslate nohighlight">\(x^{T}Ax &gt; 0\)</span> for all nonzero <span class="math notranslate nohighlight">\(x \in \mathbb{R}^n\)</span>. Symmetric <em>and</em> positive definite matrices, i.e., <em>symmetric positive definite (SPD)</em> matrices, are the most important class of specially structured matrices that arise in applications.</p>
<p>Intuitively, the largest entry in an SPD matrix is on the diagonal and, more qualitatively, SPD matrices have more “mass” on the diagonal than off the diagonal.</p>
<p>If <span class="math notranslate nohighlight">\(A\)</span> can be factored in a QR-factorization, i.e., <span class="math notranslate nohighlight">\(A = QR\)</span>, then we can write:</p>
<div class="math notranslate nohighlight">
\[(QR)^T QR = A^T A\]</div>
<p>By applying the transpose of a product, we get:</p>
<div class="math notranslate nohighlight">
\[R^T Q^T  QR = A^T A\]</div>
<p>And since Q is orthogonal (remember: <span class="math notranslate nohighlight">\(QQ^T = Q^TQ =I\)</span>), we get:</p>
<div class="math notranslate nohighlight">
\[R^T( Q^T  Q)R = A^T A\]</div>
<div class="math notranslate nohighlight">
\[R^T R = A^T A\]</div>
<p>If, A is SPD, then it is possible to find a <em>lower triangular</em> matrix <span class="math notranslate nohighlight">\(L\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[L L^T = A^T A\]</div>
<p>Then, we have that <div class="math notranslate nohighlight">
\[R^{T}R = L L^{T}\]</div>
</p>
<p>Hence, the lower triangular matrix <span class="math notranslate nohighlight">\(L\)</span> is such that <span class="math notranslate nohighlight">\(L = R^T\)</span> and can be identified as the Cholesky factor of <span class="math notranslate nohighlight">\(A^TA\)</span>.</p>
<p>It follows (you can prove it yourself for exercise) that <span class="math notranslate nohighlight">\(Q = A L^{-T}\)</span>.</p>
<ul class="simple">
<li><p>Note: Cholesky decomposition is a special type of a <a class="reference external" href="https://en.wikipedia.org/wiki/LU_decomposition">LU decomposition</a>.</p></li>
</ul>
<p>We can then solve the normal equations <span class="math notranslate nohighlight">\((A^T A) x = A^T b\)</span>, as:</p>
<div class="math notranslate nohighlight">
\[
(R^T R) x \equiv (L L^{T})x = A^T b
\]</div>
<p>in 2 steps:</p>
<ul class="simple">
<li><ol class="arabic simple">
<li><p>First by solving: <span class="math notranslate nohighlight">\(R^T y = A^T b\)</span> for <span class="math notranslate nohighlight">\(y\)</span> via forward-substitution.</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="2">
<li><p>Then by solving: <span class="math notranslate nohighlight">\(Rx = y\)</span>, via backward-substitution.</p></li>
</ol>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">qr_chol</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">    </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cholesky</span><span class="p">(</span><span class="n">A</span><span class="o">&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">U</span><span class="w"> </span><span class="c"># using cholesky function from the LinearAlgebra.jl package. The decomposition produces the components L and U.</span>
<span class="w">    </span><span class="n">Q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">R</span>
<span class="w">    </span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span>
<span class="k">end</span>

<span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="c"># use a random rectangular matrix</span>
<span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qr_chol</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">Q</span><span class="o">&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Q</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">I</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">Q</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>norm(Q&#39; * Q - I) = 3.293339156204095e-15
norm(Q * R - A) = 2.1499376424746292e-16
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.1499376424746292e-16
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">LinRange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">)</span>
<span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vander</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="c"># use the Vadermonde matrix</span>
<span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qr_chol</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">Q</span><span class="o">&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Q</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">I</span><span class="p">)</span><span class="w"> </span><span class="c"># really not orthogonal</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">Q</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>norm(Q&#39; * Q - I) = 4.3924133095508784e-5
norm(Q * R - A) = 7.092119431498881e-16
</pre></div>
</div>
</div>
</div>
<section id="can-we-fix-this">
<h3>Can we fix this?<a class="headerlink" href="#can-we-fix-this" title="Link to this heading">#</a></h3>
<p>Note that the product of two triangular matrices is triangular.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">triu</span><span class="p">(</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">R</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">R</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5×5 Matrix{Float64}:
 0.165159  0.290921  1.06258   1.03038   1.3736
 0.0       0.404661  1.07645   0.776216  0.923703
 0.0       0.0       0.695147  1.25977   0.791944
 0.0       0.0       0.0       0.523937  0.730339
 0.0       0.0       0.0       0.0       0.18127
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">qr_chol2</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">    </span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qr_chol</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">    </span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qr_chol</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="w">    </span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">R</span>
<span class="k">end</span>

<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">LinRange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">)</span>
<span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vander</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="c"># use the Vadermonde matrix</span>
<span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qr_chol2</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">Q</span><span class="o">&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Q</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">I</span><span class="p">)</span><span class="w"> </span><span class="c"># orthogonal to machine precision now!</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">Q</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>norm(Q&#39; * Q - I) = 9.892569635797733e-16
norm(Q * R - A) = 7.622613303296868e-16
</pre></div>
</div>
</div>
</div>
</section>
<section id="how-fast-are-these-methods">
<h3>How fast are these methods?<a class="headerlink" href="#how-fast-are-these-methods" title="Link to this heading">#</a></h3>
<p>Let’s do some timing with Julia’s macro <a class="reference external" href="https://docs.julialang.org/en/v1/manual/performance-tips/#Measure-performance-with-%5B&#64;time%5D(&#64;ref)-and-pay-attention-to-memory-allocation"><code class="docutils literal notranslate"><span class="pre">&#64;time</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5000</span><span class="p">,</span><span class="w"> </span><span class="mi">2000</span>
<span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">randn</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>

<span class="nd">@time</span><span class="w"> </span><span class="n">qr</span><span class="p">(</span><span class="n">A</span><span class="p">);</span><span class="w"> </span><span class="c"># Julia&#39;s built-in</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0.495318 seconds (7 allocations: 77.393 MiB, 19.51% gc time)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">randn</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>
<span class="nd">@time</span><span class="w"> </span><span class="n">qr_chol</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0.619845 seconds (7 allocations: 137.329 MiB, 16.44% gc time)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="profiling">
<h2>4. Profiling<a class="headerlink" href="#profiling" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">Pkg</span>
<span class="n">Pkg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;ProfileSVG&quot;</span><span class="p">)</span>

<span class="k">using</span><span class="w"> </span><span class="n">ProfileSVG</span>

<span class="n">ProfileSVG</span><span class="o">.</span><span class="nd">@profview</span><span class="w"> </span><span class="n">qr</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold -Color-Bold-Green">   Resolving</span> package versions...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold -Color-Bold-Green">  No Changes</span> to `~/Dropbox/SDSU/Teaching/Comp526/fall25/Project.toml`
<span class=" -Color -Color-Bold -Color-Bold-Green">  No Changes</span> to `~/Dropbox/SDSU/Teaching/Comp526/fall25/Manifest.toml`
<span class=" -Color -Color-Bold -Color-Bold-Yellow">┌ Warning: </span>Circular dependency detected.
<span class=" -Color -Color-Bold -Color-Bold-Yellow">│ </span>Precompilation will be skipped for dependencies in this cycle:
<span class=" -Color -Color-Bold -Color-Bold-Yellow">│ </span> ┌ Symbolics → SymbolicsForwardDiffExt
<span class=" -Color -Color-Bold -Color-Bold-Yellow">│ </span> └─ Symbolics → SymbolicsPreallocationToolsExt
<span class=" -Color -Color-Bold -Color-Bold-Yellow">└ </span>@ Pkg.API.Precompilation ~/julia-1.10.9/share/julia/stdlib/v1.10/Pkg/src/precompilation.jl:583
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold -Color-Bold-Green">Precompiling</span> 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>packages...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   1269.1 ms<span class=" -Color -Color-Green">  ✓ </span>FlameGraphs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    464.4 ms<span class=" -Color -Color-Green">  ✓ </span>TimerOutputs → FlameGraphsExt
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    522.8 ms<span class=" -Color -Color-Green">  ✓ </span>ProfileSVG
  3 dependencies successfully precompiled in 2 seconds. 313 already precompiled. 2 skipped due to circular dependency.
</pre></div>
</div>
<div class="output text_html"><!DOCTYPE html>
<html>
<body>
<svg version="1.1" width="960" height="316" viewBox="0 0 960 316"
     xmlns="http://www.w3.org/2000/svg" id="fig-c9d3cdc6eebe4ecc91a3469103c96226">
<defs>
    <clipPath id="fig-c9d3cdc6eebe4ecc91a3469103c96226-clip">
        <rect x="0" y="0" width="960" height="316"/>
    </clipPath>
</defs>
<style type="text/css">
    #fig-c9d3cdc6eebe4ecc91a3469103c96226 text {
        pointer-events: none;
        font-family: inherit;
        font-size: 12px;
        fill: #000000;
    }
    text#fig-c9d3cdc6eebe4ecc91a3469103c96226-title {
        font-size: 16.8px;
        fill: #000000;
        text-anchor: middle;
    }
    #fig-c9d3cdc6eebe4ecc91a3469103c96226-bg {
        fill: #FFFFFF;
    }
    #fig-c9d3cdc6eebe4ecc91a3469103c96226-viewport rect, #fig-c9d3cdc6eebe4ecc91a3469103c96226-viewport path {
        vector-effect: non-scaling-stroke;
        fill-opacity: 1;
    }
    #fig-c9d3cdc6eebe4ecc91a3469103c96226-viewport text {
        stroke: #000000;
        stroke-width: 0;
        stroke-opacity: 0.35;
    }
    #fig-c9d3cdc6eebe4ecc91a3469103c96226-viewport rect:hover, #fig-c9d3cdc6eebe4ecc91a3469103c96226-viewport path:hover {
        fill-opacity: 0.75;
        stroke: #000000;
        stroke-width: 0.5;
    }
    #fig-c9d3cdc6eebe4ecc91a3469103c96226-viewport + rect {
        fill: #FFFFFF;
        opacity: 0.8;
    }
    text#fig-c9d3cdc6eebe4ecc91a3469103c96226-details{
        fill: #000000;
    }
</style>
<g id="fig-c9d3cdc6eebe4ecc91a3469103c96226-frame" clip-path="url(#fig-c9d3cdc6eebe4ecc91a3469103c96226-clip)">
<rect id="fig-c9d3cdc6eebe4ecc91a3469103c96226-bg" x="0" y="0" width="960" height="316"/>
<text id="fig-c9d3cdc6eebe4ecc91a3469103c96226-title" x="480" y="24">Profile results</text>
<g id="fig-c9d3cdc6eebe4ecc91a3469103c96226-viewport" transform="scale(1)">
<rect x="10" y="263" width="940.16" height="15" rx="2" fill="#F3004D" data-dinfo=""/>
<text x="10" dx="4" y="274.25"> in :-1</text>
<rect x="10" y="248" width="295.36" height="15" rx="2" fill="#00B58B" data-dinfo="/home/vbarra/.julia/packages/IJulia/GFGaR/src/"/>
<text x="10" dx="4" y="259.25">#33 in eventloop.jl:70</text>
<rect x="10" y="233" width="295.36" height="15" rx="2" fill="#E1B2FF" data-dinfo="/home/vbarra/.julia/packages/IJulia/GFGaR/src/"/>
<text x="10" dx="4" y="244.25">eventloop in eventloop.jl:25</text>
<rect x="10" y="218" width="295.36" height="15" rx="2" fill="#00B58B" data-dinfo="./"/>
<text x="10" dx="4" y="229.25">invokelatest in essentials.jl:889</text>
<rect x="10" y="203" width="295.36" height="15" rx="2" fill="#F3004D" data-dinfo="./"/>
<text x="10" dx="4" y="214.25">#invokelatest#2 in essentials.jl:892</text>
<rect x="10" y="188" width="295.36" height="15" rx="2" fill="#00B58B" data-dinfo="/home/vbarra/.julia/packages/IJulia/GFGaR/src/"/>
<text x="10" dx="4" y="199.25">execute_request in execute_request.jl:84</text>
<rect x="10" y="173" width="295.36" height="15" rx="2" fill="#E1B2FF" data-dinfo="./"/>
<text x="10" dx="4" y="184.25">include_string in loading.jl:2146</text>
<rect x="10" y="158" width="295.36" height="15" rx="2" fill="#D42137" data-dinfo="./"/>
<text x="10" dx="4" y="169.25">eval in boot.jl:385</text>
<rect x="10" y="143" width="280.8" height="15" rx="2" fill="#E1B2FF" data-dinfo="/cache/build/builder-amdci5-6/julialang/julia-release-1-dot-10/usr/share/julia/stdlib/v1.10/LinearAlgebra/src/"/>
<text x="10" dx="4" y="154.25">qr in qr.jl:417</text>
<rect x="10" y="128" width="116.48" height="15" rx="2" fill="#00B58B" data-dinfo="/cache/build/builder-amdci5-6/julialang/julia-release-1-dot-10/usr/share/julia/stdlib/v1.10/LinearAlgebra/src/"/>
<text x="10" dx="4" y="139.25">#qr#222 in qr.jl:419</text>
<rect x="10" y="113" width="116.48" height="15" rx="2" fill="#E1B2FF" data-dinfo="/cache/build/builder-amdci5-6/julialang/julia-release-1-dot-10/usr/share/julia/stdlib/v1.10/LinearAlgebra/src/"/>
<text x="10" dx="4" y="124.25">copy_similar in LinearAlgebra.jl:398</text>
<rect x="10" y="98" width="56.16" height="15" rx="2" fill="#00B58B" data-dinfo="./"/>
<text x="10" dx="4" y="109.25">copyto! in array.jl:388</text>
<rect x="10" y="83" width="56.16" height="15" rx="2" fill="#E1B2FF" data-dinfo="./"/>
<text x="10" dx="4" y="94.25">copyto! in array.jl:368</text>
<rect x="10" y="68" width="56.16" height="15" rx="2" fill="#00B58B" data-dinfo="./"/>
<text x="10" dx="4" y="79.25">_copyto_impl! in array.jl:376</text>
<rect x="10" y="53" width="56.16" height="15" rx="2" fill="#E1B2FF" data-dinfo="./"/>
<text x="10" dx="4" y="64.25">unsafe_copyto! in array.jl:337</text>
<rect x="10" y="38" width="56.16" height="15" rx="2" fill="#00B58B" data-dinfo="./"/>
<text x="10" dx="4" y="49.25">memmove in cmem.jl:26</text>
<rect x="66.16" y="98" width="60.32" height="15" rx="2" fill="#2CA3FF" data-dinfo="./"/>
<text x="66.16" dx="4" y="109.25">similar in array.jl:420</text>
<rect x="66.16" y="83" width="60.32" height="15" rx="2" fill="#6FDC91" data-dinfo="./"/>
<text x="66.16" dx="4" y="94.25">Array in boot.jl:487</text>
<rect x="66.16" y="68" width="60.32" height="15" rx="2" fill="#C5312F" data-dinfo="./"/>
<text x="66.16" dx="4" y="79.25">Array in boot.jl:479</text>
<rect x="126.48" y="128" width="164.32" height="15" rx="2" fill="#2CA3FF" data-dinfo="/cache/build/builder-amdci5-6/julialang/julia-release-1-dot-10/usr/share/julia/stdlib/v1.10/LinearAlgebra/src/"/>
<text x="126.48" dx="4" y="139.25">#qr#222 in qr.jl:420</text>
<rect x="126.48" y="113" width="164.32" height="15" rx="2" fill="#6FDC91" data-dinfo="/cache/build/builder-amdci5-6/julialang/julia-release-1-dot-10/usr/share/julia/stdlib/v1.10/LinearAlgebra/src/"/>
<text x="126.48" dx="4" y="124.25">qr! in qr.jl:336</text>
<rect x="126.48" y="98" width="164.32" height="15" rx="2" fill="#00B58B" data-dinfo="/cache/build/builder-amdci5-6/julialang/julia-release-1-dot-10/usr/share/julia/stdlib/v1.10/LinearAlgebra/src/"/>
<text x="126.48" dx="4" y="109.25">qr! in qr.jl:291</text>
<rect x="126.48" y="83" width="164.32" height="15" rx="2" fill="#E1B2FF" data-dinfo="/cache/build/builder-amdci5-6/julialang/julia-release-1-dot-10/usr/share/julia/stdlib/v1.10/LinearAlgebra/src/"/>
<text x="126.48" dx="4" y="94.25">#qr!#221 in qr.jl:291</text>
<rect x="126.48" y="68" width="164.32" height="15" rx="2" fill="#00B58B" data-dinfo="/cache/build/builder-amdci5-6/julialang/julia-release-1-dot-10/usr/share/julia/stdlib/v1.10/LinearAlgebra/src/"/>
<text x="126.48" dx="4" y="79.25">geqrt! in lapack.jl:722</text>
<rect x="126.48" y="53" width="164.32" height="15" rx="2" fill="#6FDC91" data-dinfo="/cache/build/builder-amdci5-6/julialang/julia-release-1-dot-10/usr/share/julia/stdlib/v1.10/LinearAlgebra/src/"/>
<text x="126.48" dx="4" y="64.25">geqrt! in lapack.jl:456</text>
</g></g>
<script><![CDATA[
// Snap.svg 0.3.0
// 
// Copyright (c) 2013 Adobe Systems Incorporated. All rights reserved.
// 
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
// 
// http://www.apache.org/licenses/LICENSE-2.0
// 
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
// 
// build: 2014-06-03
!function(a){var b,c,d="0.4.2",e="hasOwnProperty",f=/[\.\/]/,g=/\s*,\s*/,h="*",i=function(a,b){return a-b},j={n:{}},k=function(){for(var a=0,b=this.length;b>a;a++)if("undefined"!=typeof this[a])return this[a]},l=function(){for(var a=this.length;--a;)if("undefined"!=typeof this[a])return this[a]},m=function(a,d){a=String(a);var e,f=c,g=Array.prototype.slice.call(arguments,2),h=m.listeners(a),j=0,n=[],o={},p=[],q=b;p.firstDefined=k,p.lastDefined=l,b=a,c=0;for(var r=0,s=h.length;s>r;r++)"zIndex"in h[r]&&(n.push(h[r].zIndex),h[r].zIndex<0&&(o[h[r].zIndex]=h[r]));for(n.sort(i);n[j]<0;)if(e=o[n[j++] ],p.push(e.apply(d,g)),c)return c=f,p;for(r=0;s>r;r++)if(e=h[r],"zIndex"in e)if(e.zIndex==n[j]){if(p.push(e.apply(d,g)),c)break;do if(j++,e=o[n[j] ],e&&p.push(e.apply(d,g)),c)break;while(e)}else o[e.zIndex]=e;else if(p.push(e.apply(d,g)),c)break;return c=f,b=q,p};m._events=j,m.listeners=function(a){var b,c,d,e,g,i,k,l,m=a.split(f),n=j,o=[n],p=[];for(e=0,g=m.length;g>e;e++){for(l=[],i=0,k=o.length;k>i;i++)for(n=o[i].n,c=[n[m[e] ],n[h] ],d=2;d--;)b=c[d],b&&(l.push(b),p=p.concat(b.f||[]));o=l}return p},m.on=function(a,b){if(a=String(a),"function"!=typeof b)return function(){};for(var c=a.split(g),d=0,e=c.length;e>d;d++)!function(a){for(var c,d=a.split(f),e=j,g=0,h=d.length;h>g;g++)e=e.n,e=e.hasOwnProperty(d[g])&&e[d[g] ]||(e[d[g] ]={n:{}});for(e.f=e.f||[],g=0,h=e.f.length;h>g;g++)if(e.f[g]==b){c=!0;break}!c&&e.f.push(b)}(c[d]);return function(a){+a==+a&&(b.zIndex=+a)}},m.f=function(a){var b=[].slice.call(arguments,1);return function(){m.apply(null,[a,null].concat(b).concat([].slice.call(arguments,0)))}},m.stop=function(){c=1},m.nt=function(a){return a?new RegExp("(?:\\.|\\/|^)"+a+"(?:\\.|\\/|$)").test(b):b},m.nts=function(){return b.split(f)},m.off=m.unbind=function(a,b){if(!a)return void(m._events=j={n:{}});var c=a.split(g);if(c.length>1)for(var d=0,i=c.length;i>d;d++)m.off(c[d],b);else{c=a.split(f);var k,l,n,d,i,o,p,q=[j];for(d=0,i=c.length;i>d;d++)for(o=0;o<q.length;o+=n.length-2){if(n=[o,1],k=q[o].n,c[d]!=h)k[c[d] ]&&n.push(k[c[d] ]);else for(l in k)k[e](l)&&n.push(k[l]);q.splice.apply(q,n)}for(d=0,i=q.length;i>d;d++)for(k=q[d];k.n;){if(b){if(k.f){for(o=0,p=k.f.length;p>o;o++)if(k.f[o]==b){k.f.splice(o,1);break}!k.f.length&&delete k.f}for(l in k.n)if(k.n[e](l)&&k.n[l].f){var r=k.n[l].f;for(o=0,p=r.length;p>o;o++)if(r[o]==b){r.splice(o,1);break}!r.length&&delete k.n[l].f}}else{delete k.f;for(l in k.n)k.n[e](l)&&k.n[l].f&&delete k.n[l].f}k=k.n}}},m.once=function(a,b){var c=function(){return m.unbind(a,c),b.apply(this,arguments)};return m.on(a,c)},m.version=d,m.toString=function(){return"You are running Eve "+d},"undefined"!=typeof module&&module.exports?module.exports=m:"function"==typeof define&&define.amd?define("eve",[],function(){return m}):a.eve=m}(this),function(a,b){"function"==typeof define&&define.amd?define('ProfileSVG/snap.svg', ["eve"],function(c){return b(a,c)}):b(a,a.eve)}(this,function(a,b){var c=function(b){var c={},d=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(a){setTimeout(a,16)},e=Array.isArray||function(a){return a instanceof Array||"[object Array]"==Object.prototype.toString.call(a)},f=0,g="M"+(+new Date).toString(36),h=function(){return g+(f++).toString(36)},i=Date.now||function(){return+new Date},j=function(a){var b=this;if(null==a)return b.s;var c=b.s-a;b.b+=b.dur*c,b.B+=b.dur*c,b.s=a},k=function(a){var b=this;return null==a?b.spd:void(b.spd=a)},l=function(a){var b=this;return null==a?b.dur:(b.s=b.s*a/b.dur,void(b.dur=a))},m=function(){var a=this;delete c[a.id],a.update(),b("mina.stop."+a.id,a)},n=function(){var a=this;a.pdif||(delete c[a.id],a.update(),a.pdif=a.get()-a.b)},o=function(){var a=this;a.pdif&&(a.b=a.get()-a.pdif,delete a.pdif,c[a.id]=a)},p=function(){var a,b=this;if(e(b.start)){a=[];for(var c=0,d=b.start.length;d>c;c++)a[c]=+b.start[c]+(b.end[c]-b.start[c])*b.easing(b.s)}else a=+b.start+(b.end-b.start)*b.easing(b.s);b.set(a)},q=function(){var a=0;for(var e in c)if(c.hasOwnProperty(e)){var f=c[e],g=f.get();a++,f.s=(g-f.b)/(f.dur/f.spd),f.s>=1&&(delete c[e],f.s=1,a--,function(a){setTimeout(function(){b("mina.finish."+a.id,a)})}(f)),f.update()}a&&d(q)},r=function(a,b,e,f,g,i,s){var t={id:h(),start:a,end:b,b:e,s:0,dur:f-e,spd:1,get:g,set:i,easing:s||r.linear,status:j,speed:k,duration:l,stop:m,pause:n,resume:o,update:p};c[t.id]=t;var u,v=0;for(u in c)if(c.hasOwnProperty(u)&&(v++,2==v))break;return 1==v&&d(q),t};return r.time=i,r.getById=function(a){return c[a]||null},r.linear=function(a){return a},r.easeout=function(a){return Math.pow(a,1.7)},r.easein=function(a){return Math.pow(a,.48)},r.easeinout=function(a){if(1==a)return 1;if(0==a)return 0;var b=.48-a/1.04,c=Math.sqrt(.1734+b*b),d=c-b,e=Math.pow(Math.abs(d),1/3)*(0>d?-1:1),f=-c-b,g=Math.pow(Math.abs(f),1/3)*(0>f?-1:1),h=e+g+.5;return 3*(1-h)*h*h+h*h*h},r.backin=function(a){if(1==a)return 1;var b=1.70158;return a*a*((b+1)*a-b)},r.backout=function(a){if(0==a)return 0;a-=1;var b=1.70158;return a*a*((b+1)*a+b)+1},r.elastic=function(a){return a==!!a?a:Math.pow(2,-10*a)*Math.sin(2*(a-.075)*Math.PI/.3)+1},r.bounce=function(a){var b,c=7.5625,d=2.75;return 1/d>a?b=c*a*a:2/d>a?(a-=1.5/d,b=c*a*a+.75):2.5/d>a?(a-=2.25/d,b=c*a*a+.9375):(a-=2.625/d,b=c*a*a+.984375),b},a.mina=r,r}("undefined"==typeof b?function(){}:b),d=function(){function d(a,b){if(a){if(a.tagName)return y(a);if(f(a,"array")&&d.set)return d.set.apply(d,a);if(a instanceof u)return a;if(null==b)return a=z.doc.querySelector(a),y(a)}return a=null==a?"100%":a,b=null==b?"100%":b,new x(a,b)}function e(a,b){if(b){if("#text"==a&&(a=z.doc.createTextNode(b.text||"")),"string"==typeof a&&(a=e(a)),"string"==typeof b)return"xlink:"==b.substring(0,6)?a.getAttributeNS(W,b.substring(6)):"xml:"==b.substring(0,4)?a.getAttributeNS(X,b.substring(4)):a.getAttribute(b);for(var c in b)if(b[A](c)){var d=B(b[c]);d?"xlink:"==c.substring(0,6)?a.setAttributeNS(W,c.substring(6),d):"xml:"==c.substring(0,4)?a.setAttributeNS(X,c.substring(4),d):a.setAttribute(c,d):a.removeAttribute(c)}}else a=z.doc.createElementNS(X,a);return a}function f(a,b){return b=B.prototype.toLowerCase.call(b),"finite"==b?isFinite(a):"array"==b&&(a instanceof Array||Array.isArray&&Array.isArray(a))?!0:"null"==b&&null===a||b==typeof a&&null!==a||"object"==b&&a===Object(a)||L.call(a).slice(8,-1).toLowerCase()==b}function h(a){if("function"==typeof a||Object(a)!==a)return a;var b=new a.constructor;for(var c in a)a[A](c)&&(b[c]=h(a[c]));return b}function i(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return a.push(a.splice(c,1)[0])}function j(a,b,c){function d(){var e=Array.prototype.slice.call(arguments,0),f=e.join("␀"),g=d.cache=d.cache||{},h=d.count=d.count||[];return g[A](f)?(i(h,f),c?c(g[f]):g[f]):(h.length>=1e3&&delete g[h.shift()],h.push(f),g[f]=a.apply(b,e),c?c(g[f]):g[f])}return d}function k(a,b,c,d,e,f){if(null==e){var g=a-c,h=b-d;return g||h?(180+180*E.atan2(-h,-g)/I+360)%360:0}return k(a,b,e,f)-k(c,d,e,f)}function l(a){return a%360*I/180}function m(a){return 180*a/I%360}function n(a){var b=[];return a=a.replace(/(?:^|\s)(\w+)\(([^)]+)\)/g,function(a,c,d){return d=d.split(/\s*,\s*|\s+/),"rotate"==c&&1==d.length&&d.push(0,0),"scale"==c&&(d.length>2?d=d.slice(0,2):2==d.length&&d.push(0,0),1==d.length&&d.push(d[0],0,0)),b.push("skewX"==c?["m",1,0,E.tan(l(d[0])),1,0,0]:"skewY"==c?["m",1,E.tan(l(d[0])),0,1,0,0]:[c.charAt(0)].concat(d)),a}),b}function o(a,b){var c=eb(a),e=new d.Matrix;if(c)for(var f=0,g=c.length;g>f;f++){var h,i,j,k,l,m=c[f],n=m.length,o=B(m[0]).toLowerCase(),p=m[0]!=o,q=p?e.invert():0;"t"==o&&2==n?e.translate(m[1],0):"t"==o&&3==n?p?(h=q.x(0,0),i=q.y(0,0),j=q.x(m[1],m[2]),k=q.y(m[1],m[2]),e.translate(j-h,k-i)):e.translate(m[1],m[2]):"r"==o?2==n?(l=l||b,e.rotate(m[1],l.x+l.width/2,l.y+l.height/2)):4==n&&(p?(j=q.x(m[2],m[3]),k=q.y(m[2],m[3]),e.rotate(m[1],j,k)):e.rotate(m[1],m[2],m[3])):"s"==o?2==n||3==n?(l=l||b,e.scale(m[1],m[n-1],l.x+l.width/2,l.y+l.height/2)):4==n?p?(j=q.x(m[2],m[3]),k=q.y(m[2],m[3]),e.scale(m[1],m[1],j,k)):e.scale(m[1],m[1],m[2],m[3]):5==n&&(p?(j=q.x(m[3],m[4]),k=q.y(m[3],m[4]),e.scale(m[1],m[2],j,k)):e.scale(m[1],m[2],m[3],m[4])):"m"==o&&7==n&&e.add(m[1],m[2],m[3],m[4],m[5],m[6])}return e}function p(a,b){if(null==b){var c=!0;if(b=a.node.getAttribute("linearGradient"==a.type||"radialGradient"==a.type?"gradientTransform":"pattern"==a.type?"patternTransform":"transform"),!b)return new d.Matrix;b=n(b)}else b=d._.rgTransform.test(b)?B(b).replace(/\.{3}|\u2026/g,a._.transform||J):n(b),f(b,"array")&&(b=d.path?d.path.toString.call(b):B(b)),a._.transform=b;var e=o(b,a.getBBox(1));return c?e:void(a.matrix=e)}function q(a){var b=a.node.ownerSVGElement&&y(a.node.ownerSVGElement)||a.node.parentNode&&y(a.node.parentNode)||d.select("svg")||d(0,0),c=b.select("defs"),e=null==c?!1:c.node;return e||(e=w("defs",b.node).node),e}function r(a){return a.node.ownerSVGElement&&y(a.node.ownerSVGElement)||d.select("svg")}function s(a,b,c){function d(a){if(null==a)return J;if(a==+a)return a;e(j,{width:a});try{return j.getBBox().width}catch(b){return 0}}function f(a){if(null==a)return J;if(a==+a)return a;e(j,{height:a});try{return j.getBBox().height}catch(b){return 0}}function g(d,e){null==b?i[d]=e(a.attr(d)||0):d==b&&(i=e(null==c?a.attr(d)||0:c))}var h=r(a).node,i={},j=h.querySelector(".svg---mgr");switch(j||(j=e("rect"),e(j,{x:-9e9,y:-9e9,width:10,height:10,"class":"svg---mgr",fill:"none"}),h.appendChild(j)),a.type){case"rect":g("rx",d),g("ry",f);case"image":g("width",d),g("height",f);case"text":g("x",d),g("y",f);break;case"circle":g("cx",d),g("cy",f),g("r",d);break;case"ellipse":g("cx",d),g("cy",f),g("rx",d),g("ry",f);break;case"line":g("x1",d),g("x2",d),g("y1",f),g("y2",f);break;case"marker":g("refX",d),g("markerWidth",d),g("refY",f),g("markerHeight",f);break;case"radialGradient":g("fx",d),g("fy",f);break;case"tspan":g("dx",d),g("dy",f);break;default:g(b,d)}return h.removeChild(j),i}function t(a){f(a,"array")||(a=Array.prototype.slice.call(arguments,0));for(var b=0,c=0,d=this.node;this[b];)delete this[b++];for(b=0;b<a.length;b++)"set"==a[b].type?a[b].forEach(function(a){d.appendChild(a.node)}):d.appendChild(a[b].node);var e=d.childNodes;for(b=0;b<e.length;b++)this[c++]=y(e[b]);return this}function u(a){if(a.snap in Y)return Y[a.snap];var b,c=this.id=V();try{b=a.ownerSVGElement}catch(d){}if(this.node=a,b&&(this.paper=new x(b)),this.type=a.tagName,this.anims={},this._={transform:[]},a.snap=c,Y[c]=this,"g"==this.type&&(this.add=t),this.type in{g:1,mask:1,pattern:1})for(var e in x.prototype)x.prototype[A](e)&&(this[e]=x.prototype[e])}function v(a){this.node=a}function w(a,b){var c=e(a);b.appendChild(c);var d=y(c);return d}function x(a,b){var c,d,f,g=x.prototype;if(a&&"svg"==a.tagName){if(a.snap in Y)return Y[a.snap];var h=a.ownerDocument;c=new u(a),d=a.getElementsByTagName("desc")[0],f=a.getElementsByTagName("defs")[0],d||(d=e("desc"),d.appendChild(h.createTextNode("Created with Snap")),c.node.appendChild(d)),f||(f=e("defs"),c.node.appendChild(f)),c.defs=f;for(var i in g)g[A](i)&&(c[i]=g[i]);c.paper=c.root=c}else c=w("svg",z.doc.body),e(c.node,{height:b,version:1.1,width:a,xmlns:X});return c}function y(a){return a?a instanceof u||a instanceof v?a:a.tagName&&"svg"==a.tagName.toLowerCase()?new x(a):a.tagName&&"object"==a.tagName.toLowerCase()&&"image/svg+xml"==a.type?new x(a.contentDocument.getElementsByTagName("svg")[0]):new u(a):a}d.version="0.3.0",d.toString=function(){return"Snap v"+this.version},d._={};var z={win:a,doc:a.document};d._.glob=z;var A="hasOwnProperty",B=String,C=parseFloat,D=parseInt,E=Math,F=E.max,G=E.min,H=E.abs,I=(E.pow,E.PI),J=(E.round,""),K=" ",L=Object.prototype.toString,M=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?%?)\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?%?)\s*\))\s*$/i,N="	\n\x0b\f\r   ᠎             　\u2028\u2029",O=(d._.separator=new RegExp("[,"+N+"]+"),new RegExp("["+N+"]","g"),new RegExp("["+N+"]*,["+N+"]*")),P={hs:1,rg:1},Q=new RegExp("([a-z])["+N+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+N+"]*,?["+N+"]*)+)","ig"),R=new RegExp("([rstm])["+N+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+N+"]*,?["+N+"]*)+)","ig"),S=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+N+"]*,?["+N+"]*","ig"),T=0,U="S"+(+new Date).toString(36),V=function(){return U+(T++).toString(36)},W="http://www.w3.org/1999/xlink",X="http://www.w3.org/2000/svg",Y={},Z=d.url=function(a){return"url('#"+a+"')"};d._.$=e,d._.id=V,d.format=function(){var a=/\{([^\}]+)\}/g,b=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,c=function(a,c,d){var e=d;return c.replace(b,function(a,b,c,d,f){b=b||d,e&&(b in e&&(e=e[b]),"function"==typeof e&&f&&(e=e()))}),e=(null==e||e==d?a:e)+""};return function(b,d){return B(b).replace(a,function(a,b){return c(a,b,d)})}}(),d._.clone=h,d._.cacher=j,d.rad=l,d.deg=m,d.angle=k,d.is=f,d.snapTo=function(a,b,c){if(c=f(c,"finite")?c:10,f(a,"array")){for(var d=a.length;d--;)if(H(a[d]-b)<=c)return a[d]}else{a=+a;var e=b%a;if(c>e)return b-e;if(e>a-c)return b-e+a}return b},d.getRGB=j(function(a){if(!a||(a=B(a)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:bb};if("none"==a)return{r:-1,g:-1,b:-1,hex:"none",toString:bb};if(!(P[A](a.toLowerCase().substring(0,2))||"#"==a.charAt())&&(a=$(a)),!a)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:bb};var b,c,e,g,h,i,j=a.match(M);return j?(j[2]&&(e=D(j[2].substring(5),16),c=D(j[2].substring(3,5),16),b=D(j[2].substring(1,3),16)),j[3]&&(e=D((h=j[3].charAt(3))+h,16),c=D((h=j[3].charAt(2))+h,16),b=D((h=j[3].charAt(1))+h,16)),j[4]&&(i=j[4].split(O),b=C(i[0]),"%"==i[0].slice(-1)&&(b*=2.55),c=C(i[1]),"%"==i[1].slice(-1)&&(c*=2.55),e=C(i[2]),"%"==i[2].slice(-1)&&(e*=2.55),"rgba"==j[1].toLowerCase().slice(0,4)&&(g=C(i[3])),i[3]&&"%"==i[3].slice(-1)&&(g/=100)),j[5]?(i=j[5].split(O),b=C(i[0]),"%"==i[0].slice(-1)&&(b/=100),c=C(i[1]),"%"==i[1].slice(-1)&&(c/=100),e=C(i[2]),"%"==i[2].slice(-1)&&(e/=100),("deg"==i[0].slice(-3)||"°"==i[0].slice(-1))&&(b/=360),"hsba"==j[1].toLowerCase().slice(0,4)&&(g=C(i[3])),i[3]&&"%"==i[3].slice(-1)&&(g/=100),d.hsb2rgb(b,c,e,g)):j[6]?(i=j[6].split(O),b=C(i[0]),"%"==i[0].slice(-1)&&(b/=100),c=C(i[1]),"%"==i[1].slice(-1)&&(c/=100),e=C(i[2]),"%"==i[2].slice(-1)&&(e/=100),("deg"==i[0].slice(-3)||"°"==i[0].slice(-1))&&(b/=360),"hsla"==j[1].toLowerCase().slice(0,4)&&(g=C(i[3])),i[3]&&"%"==i[3].slice(-1)&&(g/=100),d.hsl2rgb(b,c,e,g)):(b=G(E.round(b),255),c=G(E.round(c),255),e=G(E.round(e),255),g=G(F(g,0),1),j={r:b,g:c,b:e,toString:bb},j.hex="#"+(16777216|e|c<<8|b<<16).toString(16).slice(1),j.opacity=f(g,"finite")?g:1,j)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:bb}},d),d.hsb=j(function(a,b,c){return d.hsb2rgb(a,b,c).hex}),d.hsl=j(function(a,b,c){return d.hsl2rgb(a,b,c).hex}),d.rgb=j(function(a,b,c,d){if(f(d,"finite")){var e=E.round;return"rgba("+[e(a),e(b),e(c),+d.toFixed(2)]+")"}return"#"+(16777216|c|b<<8|a<<16).toString(16).slice(1)});var $=function(a){var b=z.doc.getElementsByTagName("head")[0]||z.doc.getElementsByTagName("svg")[0],c="rgb(255, 0, 0)";return($=j(function(a){if("red"==a.toLowerCase())return c;b.style.color=c,b.style.color=a;var d=z.doc.defaultView.getComputedStyle(b,J).getPropertyValue("color");return d==c?null:d}))(a)},_=function(){return"hsb("+[this.h,this.s,this.b]+")"},ab=function(){return"hsl("+[this.h,this.s,this.l]+")"},bb=function(){return 1==this.opacity||null==this.opacity?this.hex:"rgba("+[this.r,this.g,this.b,this.opacity]+")"},cb=function(a,b,c){if(null==b&&f(a,"object")&&"r"in a&&"g"in a&&"b"in a&&(c=a.b,b=a.g,a=a.r),null==b&&f(a,string)){var e=d.getRGB(a);a=e.r,b=e.g,c=e.b}return(a>1||b>1||c>1)&&(a/=255,b/=255,c/=255),[a,b,c]},db=function(a,b,c,e){a=E.round(255*a),b=E.round(255*b),c=E.round(255*c);var g={r:a,g:b,b:c,opacity:f(e,"finite")?e:1,hex:d.rgb(a,b,c),toString:bb};return f(e,"finite")&&(g.opacity=e),g};d.color=function(a){var b;return f(a,"object")&&"h"in a&&"s"in a&&"b"in a?(b=d.hsb2rgb(a),a.r=b.r,a.g=b.g,a.b=b.b,a.opacity=1,a.hex=b.hex):f(a,"object")&&"h"in a&&"s"in a&&"l"in a?(b=d.hsl2rgb(a),a.r=b.r,a.g=b.g,a.b=b.b,a.opacity=1,a.hex=b.hex):(f(a,"string")&&(a=d.getRGB(a)),f(a,"object")&&"r"in a&&"g"in a&&"b"in a&&!("error"in a)?(b=d.rgb2hsl(a),a.h=b.h,a.s=b.s,a.l=b.l,b=d.rgb2hsb(a),a.v=b.b):(a={hex:"none"},a.r=a.g=a.b=a.h=a.s=a.v=a.l=-1,a.error=1)),a.toString=bb,a},d.hsb2rgb=function(a,b,c,d){f(a,"object")&&"h"in a&&"s"in a&&"b"in a&&(c=a.b,b=a.s,a=a.h,d=a.o),a*=360;var e,g,h,i,j;return a=a%360/60,j=c*b,i=j*(1-H(a%2-1)),e=g=h=c-j,a=~~a,e+=[j,i,0,0,i,j][a],g+=[i,j,j,i,0,0][a],h+=[0,0,i,j,j,i][a],db(e,g,h,d)},d.hsl2rgb=function(a,b,c,d){f(a,"object")&&"h"in a&&"s"in a&&"l"in a&&(c=a.l,b=a.s,a=a.h),(a>1||b>1||c>1)&&(a/=360,b/=100,c/=100),a*=360;var e,g,h,i,j;return a=a%360/60,j=2*b*(.5>c?c:1-c),i=j*(1-H(a%2-1)),e=g=h=c-j/2,a=~~a,e+=[j,i,0,0,i,j][a],g+=[i,j,j,i,0,0][a],h+=[0,0,i,j,j,i][a],db(e,g,h,d)},d.rgb2hsb=function(a,b,c){c=cb(a,b,c),a=c[0],b=c[1],c=c[2];var d,e,f,g;return f=F(a,b,c),g=f-G(a,b,c),d=0==g?null:f==a?(b-c)/g:f==b?(c-a)/g+2:(a-b)/g+4,d=(d+360)%6*60/360,e=0==g?0:g/f,{h:d,s:e,b:f,toString:_}},d.rgb2hsl=function(a,b,c){c=cb(a,b,c),a=c[0],b=c[1],c=c[2];var d,e,f,g,h,i;return g=F(a,b,c),h=G(a,b,c),i=g-h,d=0==i?null:g==a?(b-c)/i:g==b?(c-a)/i+2:(a-b)/i+4,d=(d+360)%6*60/360,f=(g+h)/2,e=0==i?0:.5>f?i/(2*f):i/(2-2*f),{h:d,s:e,l:f,toString:ab}},d.parsePathString=function(a){if(!a)return null;var b=d.path(a);if(b.arr)return d.path.clone(b.arr);var c={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},e=[];return f(a,"array")&&f(a[0],"array")&&(e=d.path.clone(a)),e.length||B(a).replace(Q,function(a,b,d){var f=[],g=b.toLowerCase();if(d.replace(S,function(a,b){b&&f.push(+b)}),"m"==g&&f.length>2&&(e.push([b].concat(f.splice(0,2))),g="l",b="m"==b?"l":"L"),"o"==g&&1==f.length&&e.push([b,f[0] ]),"r"==g)e.push([b].concat(f));else for(;f.length>=c[g]&&(e.push([b].concat(f.splice(0,c[g]))),c[g]););}),e.toString=d.path.toString,b.arr=d.path.clone(e),e};var eb=d.parseTransformString=function(a){if(!a)return null;var b=[];return f(a,"array")&&f(a[0],"array")&&(b=d.path.clone(a)),b.length||B(a).replace(R,function(a,c,d){{var e=[];c.toLowerCase()}d.replace(S,function(a,b){b&&e.push(+b)}),b.push([c].concat(e))}),b.toString=d.path.toString,b};d._.svgTransform2string=n,d._.rgTransform=new RegExp("^[a-z]["+N+"]*-?\\.?\\d","i"),d._.transform2matrix=o,d._unit2px=s;z.doc.contains||z.doc.compareDocumentPosition?function(a,b){var c=9==a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a==d||!(!d||1!=d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b;)if(b=b.parentNode,b==a)return!0;return!1};d._.getSomeDefs=q,d._.getSomeSVG=r,d.select=function(a){return y(z.doc.querySelector(a))},d.selectAll=function(a){for(var b=z.doc.querySelectorAll(a),c=(d.set||Array)(),e=0;e<b.length;e++)c.push(y(b[e]));return c},setInterval(function(){for(var a in Y)if(Y[A](a)){var b=Y[a],c=b.node;("svg"!=b.type&&!c.ownerSVGElement||"svg"==b.type&&(!c.parentNode||"ownerSVGElement"in c.parentNode&&!c.ownerSVGElement))&&delete Y[a]}},1e4),function(a){function g(a){function b(a,b){var c=e(a.node,b);c=c&&c.match(g),c=c&&c[2],c&&"#"==c.charAt()&&(c=c.substring(1),c&&(i[c]=(i[c]||[]).concat(function(c){var d={};d[b]=Z(c),e(a.node,d)})))}function c(a){var b=e(a.node,"xlink:href");b&&"#"==b.charAt()&&(b=b.substring(1),b&&(i[b]=(i[b]||[]).concat(function(b){a.attr("xlink:href","#"+b)})))}for(var d,f=a.selectAll("*"),g=/^\s*url\(("|'|)(.*)\1\)\s*$/,h=[],i={},j=0,k=f.length;k>j;j++){d=f[j],b(d,"fill"),b(d,"stroke"),b(d,"filter"),b(d,"mask"),b(d,"clip-path"),c(d);var l=e(d.node,"id");l&&(e(d.node,{id:d.id}),h.push({old:l,id:d.id}))}for(j=0,k=h.length;k>j;j++){var m=i[h[j].old];if(m)for(var n=0,o=m.length;o>n;n++)m[n](h[j].id)}}function h(a,b,c){return function(d){var e=d.slice(a,b);return 1==e.length&&(e=e[0]),c?c(e):e}}function i(a){return function(){var b=a?"<"+this.type:"",c=this.node.attributes,d=this.node.childNodes;if(a)for(var e=0,f=c.length;f>e;e++)b+=" "+c[e].name+'="'+c[e].value.replace(/"/g,'\\"')+'"';if(d.length){for(a&&(b+=">"),e=0,f=d.length;f>e;e++)3==d[e].nodeType?b+=d[e].nodeValue:1==d[e].nodeType&&(b+=y(d[e]).toString());a&&(b+="</"+this.type+">")}else a&&(b+="/>");return b}}a.attr=function(a,c){{var d=this;d.node}if(!a)return d;if(f(a,"string")){if(!(arguments.length>1))return b("snap.util.getattr."+a,d).firstDefined();var e={};e[a]=c,a=e}for(var g in a)a[A](g)&&b("snap.util.attr."+g,d,a[g]);return d},a.getBBox=function(a){if(!d.Matrix||!d.path)return this.node.getBBox();var b=this,c=new d.Matrix;if(b.removed)return d._.box();for(;"use"==b.type;)if(a||(c=c.add(b.transform().localMatrix.translate(b.attr("x")||0,b.attr("y")||0))),b.original)b=b.original;else{var e=b.attr("xlink:href");b=b.original=b.node.ownerDocument.getElementById(e.substring(e.indexOf("#")+1))}var f=b._,g=d.path.get[b.type]||d.path.get.deflt;try{return a?(f.bboxwt=g?d.path.getBBox(b.realPath=g(b)):d._.box(b.node.getBBox()),d._.box(f.bboxwt)):(b.realPath=g(b),b.matrix=b.transform().localMatrix,f.bbox=d.path.getBBox(d.path.map(b.realPath,c.add(b.matrix))),d._.box(f.bbox))}catch(h){return d._.box()}};var j=function(){return this.string};a.transform=function(a){var b=this._;if(null==a){for(var c,f=this,g=new d.Matrix(this.node.getCTM()),h=p(this),i=[h],k=new d.Matrix,l=h.toTransformString(),m=B(h)==B(this.matrix)?B(b.transform):l;"svg"!=f.type&&(f=f.parent());)i.push(p(f));for(c=i.length;c--;)k.add(i[c]);return{string:m,globalMatrix:g,totalMatrix:k,localMatrix:h,diffMatrix:g.clone().add(h.invert()),global:g.toTransformString(),total:k.toTransformString(),local:l,toString:j}}return a instanceof d.Matrix?this.matrix=a:p(this,a),this.node&&("linearGradient"==this.type||"radialGradient"==this.type?e(this.node,{gradientTransform:this.matrix}):"pattern"==this.type?e(this.node,{patternTransform:this.matrix}):e(this.node,{transform:this.matrix})),this},a.parent=function(){return y(this.node.parentNode)},a.append=a.add=function(a){if(a){if("set"==a.type){var b=this;return a.forEach(function(a){b.add(a)}),this}a=y(a),this.node.appendChild(a.node),a.paper=this.paper}return this},a.appendTo=function(a){return a&&(a=y(a),a.append(this)),this},a.prepend=function(a){if(a){if("set"==a.type){var b,c=this;return a.forEach(function(a){b?b.after(a):c.prepend(a),b=a}),this}a=y(a);var d=a.parent();this.node.insertBefore(a.node,this.node.firstChild),this.add&&this.add(),a.paper=this.paper,this.parent()&&this.parent().add(),d&&d.add()}return this},a.prependTo=function(a){return a=y(a),a.prepend(this),this},a.before=function(a){if("set"==a.type){var b=this;return a.forEach(function(a){var c=a.parent();b.node.parentNode.insertBefore(a.node,b.node),c&&c.add()}),this.parent().add(),this}a=y(a);var c=a.parent();return this.node.parentNode.insertBefore(a.node,this.node),this.parent()&&this.parent().add(),c&&c.add(),a.paper=this.paper,this},a.after=function(a){a=y(a);var b=a.parent();return this.node.nextSibling?this.node.parentNode.insertBefore(a.node,this.node.nextSibling):this.node.parentNode.appendChild(a.node),this.parent()&&this.parent().add(),b&&b.add(),a.paper=this.paper,this},a.insertBefore=function(a){a=y(a);var b=this.parent();return a.node.parentNode.insertBefore(this.node,a.node),this.paper=a.paper,b&&b.add(),a.parent()&&a.parent().add(),this},a.insertAfter=function(a){a=y(a);var b=this.parent();return a.node.parentNode.insertBefore(this.node,a.node.nextSibling),this.paper=a.paper,b&&b.add(),a.parent()&&a.parent().add(),this},a.remove=function(){var a=this.parent();return this.node.parentNode&&this.node.parentNode.removeChild(this.node),delete this.paper,this.removed=!0,a&&a.add(),this},a.select=function(a){return y(this.node.querySelector(a))},a.selectAll=function(a){for(var b=this.node.querySelectorAll(a),c=(d.set||Array)(),e=0;e<b.length;e++)c.push(y(b[e]));return c},a.asPX=function(a,b){return null==b&&(b=this.attr(a)),+s(this,a,b)},a.use=function(){var a,b=this.node.id;return b||(b=this.id,e(this.node,{id:b})),a="linearGradient"==this.type||"radialGradient"==this.type||"pattern"==this.type?w(this.type,this.node.parentNode):w("use",this.node.parentNode),e(a.node,{"xlink:href":"#"+b}),a.original=this,a};var k=/\S+/g;a.addClass=function(a){var b,c,d,e,f=(a||"").match(k)||[],g=this.node,h=g.className.baseVal,i=h.match(k)||[];if(f.length){for(b=0;d=f[b++];)c=i.indexOf(d),~c||i.push(d);e=i.join(" "),h!=e&&(g.className.baseVal=e)}return this},a.removeClass=function(a){var b,c,d,e,f=(a||"").match(k)||[],g=this.node,h=g.className.baseVal,i=h.match(k)||[];if(i.length){for(b=0;d=f[b++];)c=i.indexOf(d),~c&&i.splice(c,1);e=i.join(" "),h!=e&&(g.className.baseVal=e)}return this},a.hasClass=function(a){var b=this.node,c=b.className.baseVal,d=c.match(k)||[];return!!~d.indexOf(a)},a.toggleClass=function(a,b){if(null!=b)return b?this.addClass(a):this.removeClass(a);var c,d,e,f,g=(a||"").match(k)||[],h=this.node,i=h.className.baseVal,j=i.match(k)||[];for(c=0;e=g[c++];)d=j.indexOf(e),~d?j.splice(d,1):j.push(e);return f=j.join(" "),i!=f&&(h.className.baseVal=f),this},a.clone=function(){var a=y(this.node.cloneNode(!0));return e(a.node,"id")&&e(a.node,{id:a.id}),g(a),a.insertAfter(this),a},a.toDefs=function(){var a=q(this);return a.appendChild(this.node),this},a.pattern=a.toPattern=function(a,b,c,d){var g=w("pattern",q(this));return null==a&&(a=this.getBBox()),f(a,"object")&&"x"in a&&(b=a.y,c=a.width,d=a.height,a=a.x),e(g.node,{x:a,y:b,width:c,height:d,patternUnits:"userSpaceOnUse",id:g.id,viewBox:[a,b,c,d].join(" ")}),g.node.appendChild(this.node),g},a.marker=function(a,b,c,d,g,h){var i=w("marker",q(this));return null==a&&(a=this.getBBox()),f(a,"object")&&"x"in a&&(b=a.y,c=a.width,d=a.height,g=a.refX||a.cx,h=a.refY||a.cy,a=a.x),e(i.node,{viewBox:[a,b,c,d].join(K),markerWidth:c,markerHeight:d,orient:"auto",refX:g||0,refY:h||0,id:i.id}),i.node.appendChild(this.node),i};var l=function(a,b,d,e){"function"!=typeof d||d.length||(e=d,d=c.linear),this.attr=a,this.dur=b,d&&(this.easing=d),e&&(this.callback=e)};d._.Animation=l,d.animation=function(a,b,c,d){return new l(a,b,c,d)},a.inAnim=function(){var a=this,b=[];for(var c in a.anims)a.anims[A](c)&&!function(a){b.push({anim:new l(a._attrs,a.dur,a.easing,a._callback),mina:a,curStatus:a.status(),status:function(b){return a.status(b)},stop:function(){a.stop()}})}(a.anims[c]);return b},d.animate=function(a,d,e,f,g,h){"function"!=typeof g||g.length||(h=g,g=c.linear);var i=c.time(),j=c(a,d,i,i+f,c.time,e,g);return h&&b.once("mina.finish."+j.id,h),j},a.stop=function(){for(var a=this.inAnim(),b=0,c=a.length;c>b;b++)a[b].stop();return this},a.animate=function(a,d,e,g){"function"!=typeof e||e.length||(g=e,e=c.linear),a instanceof l&&(g=a.callback,e=a.easing,d=e.dur,a=a.attr);var i,j,k,m,n=[],o=[],p={},q=this;for(var r in a)if(a[A](r)){q.equal?(m=q.equal(r,B(a[r])),i=m.from,j=m.to,k=m.f):(i=+q.attr(r),j=+a[r]);var s=f(i,"array")?i.length:1;p[r]=h(n.length,n.length+s,k),n=n.concat(i),o=o.concat(j)}var t=c.time(),u=c(n,o,t,t+d,c.time,function(a){var b={};for(var c in p)p[A](c)&&(b[c]=p[c](a));q.attr(b)},e);return q.anims[u.id]=u,u._attrs=a,u._callback=g,b("snap.animcreated."+q.id,u),b.once("mina.finish."+u.id,function(){delete q.anims[u.id],g&&g.call(q)}),b.once("mina.stop."+u.id,function(){delete q.anims[u.id]}),q};var m={};a.data=function(a,c){var e=m[this.id]=m[this.id]||{};if(0==arguments.length)return b("snap.data.get."+this.id,this,e,null),e;if(1==arguments.length){if(d.is(a,"object")){for(var f in a)a[A](f)&&this.data(f,a[f]);return this}return b("snap.data.get."+this.id,this,e[a],a),e[a]}return e[a]=c,b("snap.data.set."+this.id,this,c,a),this},a.removeData=function(a){return null==a?m[this.id]={}:m[this.id]&&delete m[this.id][a],this},a.outerSVG=a.toString=i(1),a.innerSVG=i()}(u.prototype),d.parse=function(a){var b=z.doc.createDocumentFragment(),c=!0,d=z.doc.createElement("div");if(a=B(a),a.match(/^\s*<\s*svg(?:\s|>)/)||(a="<svg>"+a+"</svg>",c=!1),d.innerHTML=a,a=d.getElementsByTagName("svg")[0])if(c)b=a;else for(;a.firstChild;)b.appendChild(a.firstChild);return d.innerHTML=J,new v(b)},v.prototype.select=u.prototype.select,v.prototype.selectAll=u.prototype.selectAll,d.fragment=function(){for(var a=Array.prototype.slice.call(arguments,0),b=z.doc.createDocumentFragment(),c=0,e=a.length;e>c;c++){var f=a[c];f.node&&f.node.nodeType&&b.appendChild(f.node),f.nodeType&&b.appendChild(f),"string"==typeof f&&b.appendChild(d.parse(f).node)}return new v(b)},d._.make=w,d._.wrap=y,x.prototype.el=function(a,b){var c=w(a,this.node);return b&&c.attr(b),c},b.on("snap.util.getattr",function(){var a=b.nt();a=a.substring(a.lastIndexOf(".")+1);var c=a.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()});return fb[A](c)?this.node.ownerDocument.defaultView.getComputedStyle(this.node,null).getPropertyValue(c):e(this.node,a)});var fb={"alignment-baseline":0,"baseline-shift":0,clip:0,"clip-path":0,"clip-rule":0,color:0,"color-interpolation":0,"color-interpolation-filters":0,"color-profile":0,"color-rendering":0,cursor:0,direction:0,display:0,"dominant-baseline":0,"enable-background":0,fill:0,"fill-opacity":0,"fill-rule":0,filter:0,"flood-color":0,"flood-opacity":0,font:0,"font-family":0,"font-size":0,"font-size-adjust":0,"font-stretch":0,"font-style":0,"font-variant":0,"font-weight":0,"glyph-orientation-horizontal":0,"glyph-orientation-vertical":0,"image-rendering":0,kerning:0,"letter-spacing":0,"lighting-color":0,marker:0,"marker-end":0,"marker-mid":0,"marker-start":0,mask:0,opacity:0,overflow:0,"pointer-events":0,"shape-rendering":0,"stop-color":0,"stop-opacity":0,stroke:0,"stroke-dasharray":0,"stroke-dashoffset":0,"stroke-linecap":0,"stroke-linejoin":0,"stroke-miterlimit":0,"stroke-opacity":0,"stroke-width":0,"text-anchor":0,"text-decoration":0,"text-rendering":0,"unicode-bidi":0,visibility:0,"word-spacing":0,"writing-mode":0};b.on("snap.util.attr",function(a){var c=b.nt(),d={};c=c.substring(c.lastIndexOf(".")+1),d[c]=a;var f=c.replace(/-(\w)/gi,function(a,b){return b.toUpperCase()}),g=c.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()});fb[A](g)?this.node.style[f]=null==a?J:a:e(this.node,d)}),function(){}(x.prototype),d.ajax=function(a,c,d,e){var g=new XMLHttpRequest,h=V();if(g){if(f(c,"function"))e=d,d=c,c=null;else if(f(c,"object")){var i=[];for(var j in c)c.hasOwnProperty(j)&&i.push(encodeURIComponent(j)+"="+encodeURIComponent(c[j]));c=i.join("&")}return g.open(c?"POST":"GET",a,!0),c&&(g.setRequestHeader("X-Requested-With","XMLHttpRequest"),g.setRequestHeader("Content-type","application/x-www-form-urlencoded")),d&&(b.once("snap.ajax."+h+".0",d),b.once("snap.ajax."+h+".200",d),b.once("snap.ajax."+h+".304",d)),g.onreadystatechange=function(){4==g.readyState&&b("snap.ajax."+h+"."+g.status,e,g)},4==g.readyState?g:(g.send(c),g)}},d.load=function(a,b,c){d.ajax(a,function(a){var e=d.parse(a.responseText);c?b.call(c,e):b(e)})};var gb=function(a){var b=a.getBoundingClientRect(),c=a.ownerDocument,d=c.body,e=c.documentElement,f=e.clientTop||d.clientTop||0,h=e.clientLeft||d.clientLeft||0,i=b.top+(g.win.pageYOffset||e.scrollTop||d.scrollTop)-f,j=b.left+(g.win.pageXOffset||e.scrollLeft||d.scrollLeft)-h;return{y:i,x:j}};return d.getElementByPoint=function(a,b){var c=this,d=(c.canvas,z.doc.elementFromPoint(a,b));if(z.win.opera&&"svg"==d.tagName){var e=gb(d),f=d.createSVGRect();f.x=a-e.x,f.y=b-e.y,f.width=f.height=1;var g=d.getIntersectionList(f,null);g.length&&(d=g[g.length-1])}return d?y(d):null},d.plugin=function(a){a(d,u,x,z,v)},z.win.Snap=d,d}();return d.plugin(function(a){function b(a,b,d,e,f,g){return null==b&&"[object SVGMatrix]"==c.call(a)?(this.a=a.a,this.b=a.b,this.c=a.c,this.d=a.d,this.e=a.e,void(this.f=a.f)):void(null!=a?(this.a=+a,this.b=+b,this.c=+d,this.d=+e,this.e=+f,this.f=+g):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0))}var c=Object.prototype.toString,d=String,e=Math,f="";!function(c){function g(a){return a[0]*a[0]+a[1]*a[1]
}function h(a){var b=e.sqrt(g(a));a[0]&&(a[0]/=b),a[1]&&(a[1]/=b)}c.add=function(a,c,d,e,f,g){var h,i,j,k,l=[[],[],[] ],m=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1] ],n=[[a,d,f],[c,e,g],[0,0,1] ];for(a&&a instanceof b&&(n=[[a.a,a.c,a.e],[a.b,a.d,a.f],[0,0,1] ]),h=0;3>h;h++)for(i=0;3>i;i++){for(k=0,j=0;3>j;j++)k+=m[h][j]*n[j][i];l[h][i]=k}return this.a=l[0][0],this.b=l[1][0],this.c=l[0][1],this.d=l[1][1],this.e=l[0][2],this.f=l[1][2],this},c.invert=function(){var a=this,c=a.a*a.d-a.b*a.c;return new b(a.d/c,-a.b/c,-a.c/c,a.a/c,(a.c*a.f-a.d*a.e)/c,(a.b*a.e-a.a*a.f)/c)},c.clone=function(){return new b(this.a,this.b,this.c,this.d,this.e,this.f)},c.translate=function(a,b){return this.add(1,0,0,1,a,b)},c.scale=function(a,b,c,d){return null==b&&(b=a),(c||d)&&this.add(1,0,0,1,c,d),this.add(a,0,0,b,0,0),(c||d)&&this.add(1,0,0,1,-c,-d),this},c.rotate=function(b,c,d){b=a.rad(b),c=c||0,d=d||0;var f=+e.cos(b).toFixed(9),g=+e.sin(b).toFixed(9);return this.add(f,g,-g,f,c,d),this.add(1,0,0,1,-c,-d)},c.x=function(a,b){return a*this.a+b*this.c+this.e},c.y=function(a,b){return a*this.b+b*this.d+this.f},c.get=function(a){return+this[d.fromCharCode(97+a)].toFixed(4)},c.toString=function(){return"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")"},c.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},c.determinant=function(){return this.a*this.d-this.b*this.c},c.split=function(){var b={};b.dx=this.e,b.dy=this.f;var c=[[this.a,this.c],[this.b,this.d] ];b.scalex=e.sqrt(g(c[0])),h(c[0]),b.shear=c[0][0]*c[1][0]+c[0][1]*c[1][1],c[1]=[c[1][0]-c[0][0]*b.shear,c[1][1]-c[0][1]*b.shear],b.scaley=e.sqrt(g(c[1])),h(c[1]),b.shear/=b.scaley,this.determinant()<0&&(b.scalex=-b.scalex);var d=-c[0][1],f=c[1][1];return 0>f?(b.rotate=a.deg(e.acos(f)),0>d&&(b.rotate=360-b.rotate)):b.rotate=a.deg(e.asin(d)),b.isSimple=!(+b.shear.toFixed(9)||b.scalex.toFixed(9)!=b.scaley.toFixed(9)&&b.rotate),b.isSuperSimple=!+b.shear.toFixed(9)&&b.scalex.toFixed(9)==b.scaley.toFixed(9)&&!b.rotate,b.noRotation=!+b.shear.toFixed(9)&&!b.rotate,b},c.toTransformString=function(a){var b=a||this.split();return+b.shear.toFixed(9)?"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]:(b.scalex=+b.scalex.toFixed(4),b.scaley=+b.scaley.toFixed(4),b.rotate=+b.rotate.toFixed(4),(b.dx||b.dy?"t"+[+b.dx.toFixed(4),+b.dy.toFixed(4)]:f)+(1!=b.scalex||1!=b.scaley?"s"+[b.scalex,b.scaley,0,0]:f)+(b.rotate?"r"+[+b.rotate.toFixed(4),0,0]:f))}}(b.prototype),a.Matrix=b,a.matrix=function(a,c,d,e,f,g){return new b(a,c,d,e,f,g)}}),d.plugin(function(a,c,d,e,f){function g(d){return function(e){if(b.stop(),e instanceof f&&1==e.node.childNodes.length&&("radialGradient"==e.node.firstChild.tagName||"linearGradient"==e.node.firstChild.tagName||"pattern"==e.node.firstChild.tagName)&&(e=e.node.firstChild,n(this).appendChild(e),e=l(e)),e instanceof c)if("radialGradient"==e.type||"linearGradient"==e.type||"pattern"==e.type){e.node.id||p(e.node,{id:e.id});var g=q(e.node.id)}else g=e.attr(d);else if(g=a.color(e),g.error){var h=a(n(this).ownerSVGElement).gradient(e);h?(h.node.id||p(h.node,{id:h.id}),g=q(h.node.id)):g=e}else g=r(g);var i={};i[d]=g,p(this.node,i),this.node.style[d]=t}}function h(a){b.stop(),a==+a&&(a+="px"),this.node.style.fontSize=a}function i(a){for(var b=[],c=a.childNodes,d=0,e=c.length;e>d;d++){var f=c[d];3==f.nodeType&&b.push(f.nodeValue),"tspan"==f.tagName&&b.push(1==f.childNodes.length&&3==f.firstChild.nodeType?f.firstChild.nodeValue:i(f))}return b}function j(){return b.stop(),this.node.style.fontSize}var k=a._.make,l=a._.wrap,m=a.is,n=a._.getSomeDefs,o=/^url\(#?([^)]+)\)$/,p=a._.$,q=a.url,r=String,s=a._.separator,t="";b.on("snap.util.attr.mask",function(a){if(a instanceof c||a instanceof f){if(b.stop(),a instanceof f&&1==a.node.childNodes.length&&(a=a.node.firstChild,n(this).appendChild(a),a=l(a)),"mask"==a.type)var d=a;else d=k("mask",n(this)),d.node.appendChild(a.node);!d.node.id&&p(d.node,{id:d.id}),p(this.node,{mask:q(d.id)})}}),function(a){b.on("snap.util.attr.clip",a),b.on("snap.util.attr.clip-path",a),b.on("snap.util.attr.clipPath",a)}(function(a){if(a instanceof c||a instanceof f){if(b.stop(),"clipPath"==a.type)var d=a;else d=k("clipPath",n(this)),d.node.appendChild(a.node),!d.node.id&&p(d.node,{id:d.id});p(this.node,{"clip-path":q(d.id)})}}),b.on("snap.util.attr.fill",g("fill")),b.on("snap.util.attr.stroke",g("stroke"));var u=/^([lr])(?:\(([^)]*)\))?(.*)$/i;b.on("snap.util.grad.parse",function(a){a=r(a);var b=a.match(u);if(!b)return null;var c=b[1],d=b[2],e=b[3];return d=d.split(/\s*,\s*/).map(function(a){return+a==a?+a:a}),1==d.length&&0==d[0]&&(d=[]),e=e.split("-"),e=e.map(function(a){a=a.split(":");var b={color:a[0]};return a[1]&&(b.offset=parseFloat(a[1])),b}),{type:c,params:d,stops:e}}),b.on("snap.util.attr.d",function(c){b.stop(),m(c,"array")&&m(c[0],"array")&&(c=a.path.toString.call(c)),c=r(c),c.match(/[ruo]/i)&&(c=a.path.toAbsolute(c)),p(this.node,{d:c})})(-1),b.on("snap.util.attr.#text",function(a){b.stop(),a=r(a);for(var c=e.doc.createTextNode(a);this.node.firstChild;)this.node.removeChild(this.node.firstChild);this.node.appendChild(c)})(-1),b.on("snap.util.attr.path",function(a){b.stop(),this.attr({d:a})})(-1),b.on("snap.util.attr.class",function(a){b.stop(),this.node.className.baseVal=a})(-1),b.on("snap.util.attr.viewBox",function(a){var c;c=m(a,"object")&&"x"in a?[a.x,a.y,a.width,a.height].join(" "):m(a,"array")?a.join(" "):a,p(this.node,{viewBox:c}),b.stop()})(-1),b.on("snap.util.attr.transform",function(a){this.transform(a),b.stop()})(-1),b.on("snap.util.attr.r",function(a){"rect"==this.type&&(b.stop(),p(this.node,{rx:a,ry:a}))})(-1),b.on("snap.util.attr.textpath",function(a){if(b.stop(),"text"==this.type){var d,e,f;if(!a&&this.textPath){for(e=this.textPath;e.node.firstChild;)this.node.appendChild(e.node.firstChild);return e.remove(),void delete this.textPath}if(m(a,"string")){var g=n(this),h=l(g.parentNode).path(a);g.appendChild(h.node),d=h.id,h.attr({id:d})}else a=l(a),a instanceof c&&(d=a.attr("id"),d||(d=a.id,a.attr({id:d})));if(d)if(e=this.textPath,f=this.node,e)e.attr({"xlink:href":"#"+d});else{for(e=p("textPath",{"xlink:href":"#"+d});f.firstChild;)e.appendChild(f.firstChild);f.appendChild(e),this.textPath=l(e)}}})(-1),b.on("snap.util.attr.text",function(a){if("text"==this.type){for(var c=this.node,d=function(a){var b=p("tspan");if(m(a,"array"))for(var c=0;c<a.length;c++)b.appendChild(d(a[c]));else b.appendChild(e.doc.createTextNode(a));return b.normalize&&b.normalize(),b};c.firstChild;)c.removeChild(c.firstChild);for(var f=d(a);f.firstChild;)c.appendChild(f.firstChild)}b.stop()})(-1),b.on("snap.util.attr.fontSize",h)(-1),b.on("snap.util.attr.font-size",h)(-1),b.on("snap.util.getattr.transform",function(){return b.stop(),this.transform()})(-1),b.on("snap.util.getattr.textpath",function(){return b.stop(),this.textPath})(-1),function(){function c(c){return function(){b.stop();var d=e.doc.defaultView.getComputedStyle(this.node,null).getPropertyValue("marker-"+c);return"none"==d?d:a(e.doc.getElementById(d.match(o)[1]))}}function d(a){return function(c){b.stop();var d="marker"+a.charAt(0).toUpperCase()+a.substring(1);if(""==c||!c)return void(this.node.style[d]="none");if("marker"==c.type){var e=c.node.id;return e||p(c.node,{id:c.id}),void(this.node.style[d]=q(e))}}}b.on("snap.util.getattr.marker-end",c("end"))(-1),b.on("snap.util.getattr.markerEnd",c("end"))(-1),b.on("snap.util.getattr.marker-start",c("start"))(-1),b.on("snap.util.getattr.markerStart",c("start"))(-1),b.on("snap.util.getattr.marker-mid",c("mid"))(-1),b.on("snap.util.getattr.markerMid",c("mid"))(-1),b.on("snap.util.attr.marker-end",d("end"))(-1),b.on("snap.util.attr.markerEnd",d("end"))(-1),b.on("snap.util.attr.marker-start",d("start"))(-1),b.on("snap.util.attr.markerStart",d("start"))(-1),b.on("snap.util.attr.marker-mid",d("mid"))(-1),b.on("snap.util.attr.markerMid",d("mid"))(-1)}(),b.on("snap.util.getattr.r",function(){return"rect"==this.type&&p(this.node,"rx")==p(this.node,"ry")?(b.stop(),p(this.node,"rx")):void 0})(-1),b.on("snap.util.getattr.text",function(){if("text"==this.type||"tspan"==this.type){b.stop();var a=i(this.node);return 1==a.length?a[0]:a}})(-1),b.on("snap.util.getattr.#text",function(){return this.node.textContent})(-1),b.on("snap.util.getattr.viewBox",function(){b.stop();var c=p(this.node,"viewBox");return c?(c=c.split(s),a._.box(+c[0],+c[1],+c[2],+c[3])):void 0})(-1),b.on("snap.util.getattr.points",function(){var a=p(this.node,"points");return b.stop(),a?a.split(s):void 0})(-1),b.on("snap.util.getattr.path",function(){var a=p(this.node,"d");return b.stop(),a})(-1),b.on("snap.util.getattr.class",function(){return this.node.className.baseVal})(-1),b.on("snap.util.getattr.fontSize",j)(-1),b.on("snap.util.getattr.font-size",j)(-1)}),d.plugin(function(){function a(a){return a}function c(a){return function(b){return+b.toFixed(3)+a}}var d={"+":function(a,b){return a+b},"-":function(a,b){return a-b},"/":function(a,b){return a/b},"*":function(a,b){return a*b}},e=String,f=/[a-z]+$/i,g=/^\s*([+\-\/*])\s*=\s*([\d.eE+\-]+)\s*([^\d\s]+)?\s*$/;b.on("snap.util.attr",function(a){var c=e(a).match(g);if(c){var h=b.nt(),i=h.substring(h.lastIndexOf(".")+1),j=this.attr(i),k={};b.stop();var l=c[3]||"",m=j.match(f),n=d[c[1] ];if(m&&m==l?a=n(parseFloat(j),+c[2]):(j=this.asPX(i),a=n(this.asPX(i),this.asPX(i,c[2]+l))),isNaN(j)||isNaN(a))return;k[i]=a,this.attr(k)}})(-10),b.on("snap.util.equal",function(h,i){var j=e(this.attr(h)||""),k=e(i).match(g);if(k){b.stop();var l=k[3]||"",m=j.match(f),n=d[k[1] ];return m&&m==l?{from:parseFloat(j),to:n(parseFloat(j),+k[2]),f:c(m)}:(j=this.asPX(h),{from:j,to:n(j,this.asPX(h,k[2]+l)),f:a})}})(-10)}),d.plugin(function(a,c,d,e){var f=d.prototype,g=a.is;f.rect=function(a,b,c,d,e,f){var h;return null==f&&(f=e),g(a,"object")&&"[object Object]"==a?h=a:null!=a&&(h={x:a,y:b,width:c,height:d},null!=e&&(h.rx=e,h.ry=f)),this.el("rect",h)},f.circle=function(a,b,c){var d;return g(a,"object")&&"[object Object]"==a?d=a:null!=a&&(d={cx:a,cy:b,r:c}),this.el("circle",d)};var h=function(){function a(){this.parentNode.removeChild(this)}return function(b,c){var d=e.doc.createElement("img"),f=e.doc.body;d.style.cssText="position:absolute;left:-9999em;top:-9999em",d.onload=function(){c.call(d),d.onload=d.onerror=null,f.removeChild(d)},d.onerror=a,f.appendChild(d),d.src=b}}();f.image=function(b,c,d,e,f){var i=this.el("image");if(g(b,"object")&&"src"in b)i.attr(b);else if(null!=b){var j={"xlink:href":b,preserveAspectRatio:"none"};null!=c&&null!=d&&(j.x=c,j.y=d),null!=e&&null!=f?(j.width=e,j.height=f):h(b,function(){a._.$(i.node,{width:this.offsetWidth,height:this.offsetHeight})}),a._.$(i.node,j)}return i},f.ellipse=function(a,b,c,d){var e;return g(a,"object")&&"[object Object]"==a?e=a:null!=a&&(e={cx:a,cy:b,rx:c,ry:d}),this.el("ellipse",e)},f.path=function(a){var b;return g(a,"object")&&!g(a,"array")?b=a:a&&(b={d:a}),this.el("path",b)},f.group=f.g=function(a){var b=this.el("g");return 1==arguments.length&&a&&!a.type?b.attr(a):arguments.length&&b.add(Array.prototype.slice.call(arguments,0)),b},f.svg=function(a,b,c,d,e,f,h,i){var j={};return g(a,"object")&&null==b?j=a:(null!=a&&(j.x=a),null!=b&&(j.y=b),null!=c&&(j.width=c),null!=d&&(j.height=d),null!=e&&null!=f&&null!=h&&null!=i&&(j.viewBox=[e,f,h,i])),this.el("svg",j)},f.mask=function(a){var b=this.el("mask");return 1==arguments.length&&a&&!a.type?b.attr(a):arguments.length&&b.add(Array.prototype.slice.call(arguments,0)),b},f.ptrn=function(a,b,c,d,e,f,h,i){if(g(a,"object"))var j=a;else arguments.length?(j={},null!=a&&(j.x=a),null!=b&&(j.y=b),null!=c&&(j.width=c),null!=d&&(j.height=d),null!=e&&null!=f&&null!=h&&null!=i&&(j.viewBox=[e,f,h,i])):j={patternUnits:"userSpaceOnUse"};return this.el("pattern",j)},f.use=function(a){if(null!=a){{make("use",this.node)}return a instanceof c&&(a.attr("id")||a.attr({id:ID()}),a=a.attr("id")),this.el("use",{"xlink:href":a})}return c.prototype.use.call(this)},f.text=function(a,b,c){var d={};return g(a,"object")?d=a:null!=a&&(d={x:a,y:b,text:c||""}),this.el("text",d)},f.line=function(a,b,c,d){var e={};return g(a,"object")?e=a:null!=a&&(e={x1:a,x2:c,y1:b,y2:d}),this.el("line",e)},f.polyline=function(a){arguments.length>1&&(a=Array.prototype.slice.call(arguments,0));var b={};return g(a,"object")&&!g(a,"array")?b=a:null!=a&&(b={points:a}),this.el("polyline",b)},f.polygon=function(a){arguments.length>1&&(a=Array.prototype.slice.call(arguments,0));var b={};return g(a,"object")&&!g(a,"array")?b=a:null!=a&&(b={points:a}),this.el("polygon",b)},function(){function c(){return this.selectAll("stop")}function d(b,c){var d=j("stop"),e={offset:+c+"%"};return b=a.color(b),e["stop-color"]=b.hex,b.opacity<1&&(e["stop-opacity"]=b.opacity),j(d,e),this.node.appendChild(d),this}function e(){if("linearGradient"==this.type){var b=j(this.node,"x1")||0,c=j(this.node,"x2")||1,d=j(this.node,"y1")||0,e=j(this.node,"y2")||0;return a._.box(b,d,math.abs(c-b),math.abs(e-d))}var f=this.node.cx||.5,g=this.node.cy||.5,h=this.node.r||0;return a._.box(f-h,g-h,2*h,2*h)}function g(a,c){function d(a,b){for(var c=(b-l)/(a-m),d=m;a>d;d++)g[d].offset=+(+l+c*(d-m)).toFixed(2);m=a,l=b}var e,f=b("snap.util.grad.parse",null,c).firstDefined();if(!f)return null;f.params.unshift(a),e="l"==f.type.toLowerCase()?h.apply(0,f.params):i.apply(0,f.params),f.type!=f.type.toLowerCase()&&j(e.node,{gradientUnits:"userSpaceOnUse"});var g=f.stops,k=g.length,l=0,m=0;k--;for(var n=0;k>n;n++)"offset"in g[n]&&d(n,g[n].offset);for(g[k].offset=g[k].offset||100,d(k,g[k].offset),n=0;k>=n;n++){var o=g[n];e.addStop(o.color,o.offset)}return e}function h(b,f,g,h,i){var k=a._.make("linearGradient",b);return k.stops=c,k.addStop=d,k.getBBox=e,null!=f&&j(k.node,{x1:f,y1:g,x2:h,y2:i}),k}function i(b,f,g,h,i,k){var l=a._.make("radialGradient",b);return l.stops=c,l.addStop=d,l.getBBox=e,null!=f&&j(l.node,{cx:f,cy:g,r:h}),null!=i&&null!=k&&j(l.node,{fx:i,fy:k}),l}var j=a._.$;f.gradient=function(a){return g(this.defs,a)},f.gradientLinear=function(a,b,c,d){return h(this.defs,a,b,c,d)},f.gradientRadial=function(a,b,c,d,e){return i(this.defs,a,b,c,d,e)},f.toString=function(){var b,c=this.node.ownerDocument,d=c.createDocumentFragment(),e=c.createElement("div"),f=this.node.cloneNode(!0);return d.appendChild(e),e.appendChild(f),a._.$(f,{xmlns:"http://www.w3.org/2000/svg"}),b=e.innerHTML,d.removeChild(d.firstChild),b},f.clear=function(){for(var a,b=this.node.firstChild;b;)a=b.nextSibling,"defs"!=b.tagName?b.parentNode.removeChild(b):f.clear.call({node:b}),b=a}}()}),d.plugin(function(a,b){function c(a){var b=c.ps=c.ps||{};return b[a]?b[a].sleep=100:b[a]={sleep:100},setTimeout(function(){for(var c in b)b[K](c)&&c!=a&&(b[c].sleep--,!b[c].sleep&&delete b[c])}),b[a]}function d(a,b,c,d){return null==a&&(a=b=c=d=0),null==b&&(b=a.y,c=a.width,d=a.height,a=a.x),{x:a,y:b,width:c,w:c,height:d,h:d,x2:a+c,y2:b+d,cx:a+c/2,cy:b+d/2,r1:N.min(c,d)/2,r2:N.max(c,d)/2,r0:N.sqrt(c*c+d*d)/2,path:w(a,b,c,d),vb:[a,b,c,d].join(" ")}}function e(){return this.join(",").replace(L,"$1")}function f(a){var b=J(a);return b.toString=e,b}function g(a,b,c,d,e,f,g,h,j){return null==j?n(a,b,c,d,e,f,g,h):i(a,b,c,d,e,f,g,h,o(a,b,c,d,e,f,g,h,j))}function h(c,d){function e(a){return+(+a).toFixed(3)}return a._.cacher(function(a,f,h){a instanceof b&&(a=a.attr("d")),a=E(a);for(var j,k,l,m,n,o="",p={},q=0,r=0,s=a.length;s>r;r++){if(l=a[r],"M"==l[0])j=+l[1],k=+l[2];else{if(m=g(j,k,l[1],l[2],l[3],l[4],l[5],l[6]),q+m>f){if(d&&!p.start){if(n=g(j,k,l[1],l[2],l[3],l[4],l[5],l[6],f-q),o+=["C"+e(n.start.x),e(n.start.y),e(n.m.x),e(n.m.y),e(n.x),e(n.y)],h)return o;p.start=o,o=["M"+e(n.x),e(n.y)+"C"+e(n.n.x),e(n.n.y),e(n.end.x),e(n.end.y),e(l[5]),e(l[6])].join(),q+=m,j=+l[5],k=+l[6];continue}if(!c&&!d)return n=g(j,k,l[1],l[2],l[3],l[4],l[5],l[6],f-q)}q+=m,j=+l[5],k=+l[6]}o+=l.shift()+l}return p.end=o,n=c?q:d?p:i(j,k,l[0],l[1],l[2],l[3],l[4],l[5],1)},null,a._.clone)}function i(a,b,c,d,e,f,g,h,i){var j=1-i,k=R(j,3),l=R(j,2),m=i*i,n=m*i,o=k*a+3*l*i*c+3*j*i*i*e+n*g,p=k*b+3*l*i*d+3*j*i*i*f+n*h,q=a+2*i*(c-a)+m*(e-2*c+a),r=b+2*i*(d-b)+m*(f-2*d+b),s=c+2*i*(e-c)+m*(g-2*e+c),t=d+2*i*(f-d)+m*(h-2*f+d),u=j*a+i*c,v=j*b+i*d,w=j*e+i*g,x=j*f+i*h,y=90-180*N.atan2(q-s,r-t)/O;return{x:o,y:p,m:{x:q,y:r},n:{x:s,y:t},start:{x:u,y:v},end:{x:w,y:x},alpha:y}}function j(b,c,e,f,g,h,i,j){a.is(b,"array")||(b=[b,c,e,f,g,h,i,j]);var k=D.apply(null,b);return d(k.min.x,k.min.y,k.max.x-k.min.x,k.max.y-k.min.y)}function k(a,b,c){return b>=a.x&&b<=a.x+a.width&&c>=a.y&&c<=a.y+a.height}function l(a,b){return a=d(a),b=d(b),k(b,a.x,a.y)||k(b,a.x2,a.y)||k(b,a.x,a.y2)||k(b,a.x2,a.y2)||k(a,b.x,b.y)||k(a,b.x2,b.y)||k(a,b.x,b.y2)||k(a,b.x2,b.y2)||(a.x<b.x2&&a.x>b.x||b.x<a.x2&&b.x>a.x)&&(a.y<b.y2&&a.y>b.y||b.y<a.y2&&b.y>a.y)}function m(a,b,c,d,e){var f=-3*b+9*c-9*d+3*e,g=a*f+6*b-12*c+6*d;return a*g-3*b+3*c}function n(a,b,c,d,e,f,g,h,i){null==i&&(i=1),i=i>1?1:0>i?0:i;for(var j=i/2,k=12,l=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],n=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],o=0,p=0;k>p;p++){var q=j*l[p]+j,r=m(q,a,c,e,g),s=m(q,b,d,f,h),t=r*r+s*s;o+=n[p]*N.sqrt(t)}return j*o}function o(a,b,c,d,e,f,g,h,i){if(!(0>i||n(a,b,c,d,e,f,g,h)<i)){var j,k=1,l=k/2,m=k-l,o=.01;for(j=n(a,b,c,d,e,f,g,h,m);S(j-i)>o;)l/=2,m+=(i>j?1:-1)*l,j=n(a,b,c,d,e,f,g,h,m);return m}}function p(a,b,c,d,e,f,g,h){if(!(Q(a,c)<P(e,g)||P(a,c)>Q(e,g)||Q(b,d)<P(f,h)||P(b,d)>Q(f,h))){var i=(a*d-b*c)*(e-g)-(a-c)*(e*h-f*g),j=(a*d-b*c)*(f-h)-(b-d)*(e*h-f*g),k=(a-c)*(f-h)-(b-d)*(e-g);if(k){var l=i/k,m=j/k,n=+l.toFixed(2),o=+m.toFixed(2);if(!(n<+P(a,c).toFixed(2)||n>+Q(a,c).toFixed(2)||n<+P(e,g).toFixed(2)||n>+Q(e,g).toFixed(2)||o<+P(b,d).toFixed(2)||o>+Q(b,d).toFixed(2)||o<+P(f,h).toFixed(2)||o>+Q(f,h).toFixed(2)))return{x:l,y:m}}}}function q(a,b,c){var d=j(a),e=j(b);if(!l(d,e))return c?0:[];for(var f=n.apply(0,a),g=n.apply(0,b),h=~~(f/8),k=~~(g/8),m=[],o=[],q={},r=c?0:[],s=0;h+1>s;s++){var t=i.apply(0,a.concat(s/h));m.push({x:t.x,y:t.y,t:s/h})}for(s=0;k+1>s;s++)t=i.apply(0,b.concat(s/k)),o.push({x:t.x,y:t.y,t:s/k});for(s=0;h>s;s++)for(var u=0;k>u;u++){var v=m[s],w=m[s+1],x=o[u],y=o[u+1],z=S(w.x-v.x)<.001?"y":"x",A=S(y.x-x.x)<.001?"y":"x",B=p(v.x,v.y,w.x,w.y,x.x,x.y,y.x,y.y);if(B){if(q[B.x.toFixed(4)]==B.y.toFixed(4))continue;q[B.x.toFixed(4)]=B.y.toFixed(4);var C=v.t+S((B[z]-v[z])/(w[z]-v[z]))*(w.t-v.t),D=x.t+S((B[A]-x[A])/(y[A]-x[A]))*(y.t-x.t);C>=0&&1>=C&&D>=0&&1>=D&&(c?r++:r.push({x:B.x,y:B.y,t1:C,t2:D}))}}return r}function r(a,b){return t(a,b)}function s(a,b){return t(a,b,1)}function t(a,b,c){a=E(a),b=E(b);for(var d,e,f,g,h,i,j,k,l,m,n=c?0:[],o=0,p=a.length;p>o;o++){var r=a[o];if("M"==r[0])d=h=r[1],e=i=r[2];else{"C"==r[0]?(l=[d,e].concat(r.slice(1)),d=l[6],e=l[7]):(l=[d,e,d,e,h,i,h,i],d=h,e=i);for(var s=0,t=b.length;t>s;s++){var u=b[s];if("M"==u[0])f=j=u[1],g=k=u[2];else{"C"==u[0]?(m=[f,g].concat(u.slice(1)),f=m[6],g=m[7]):(m=[f,g,f,g,j,k,j,k],f=j,g=k);var v=q(l,m,c);if(c)n+=v;else{for(var w=0,x=v.length;x>w;w++)v[w].segment1=o,v[w].segment2=s,v[w].bez1=l,v[w].bez2=m;n=n.concat(v)}}}}}return n}function u(a,b,c){var d=v(a);return k(d,b,c)&&t(a,[["M",b,c],["H",d.x2+10] ],1)%2==1}function v(a){var b=c(a);if(b.bbox)return J(b.bbox);if(!a)return d();a=E(a);for(var e,f=0,g=0,h=[],i=[],j=0,k=a.length;k>j;j++)if(e=a[j],"M"==e[0])f=e[1],g=e[2],h.push(f),i.push(g);else{var l=D(f,g,e[1],e[2],e[3],e[4],e[5],e[6]);h=h.concat(l.min.x,l.max.x),i=i.concat(l.min.y,l.max.y),f=e[5],g=e[6]}var m=P.apply(0,h),n=P.apply(0,i),o=Q.apply(0,h),p=Q.apply(0,i),q=d(m,n,o-m,p-n);return b.bbox=J(q),q}function w(a,b,c,d,f){if(f)return[["M",+a+ +f,b],["l",c-2*f,0],["a",f,f,0,0,1,f,f],["l",0,d-2*f],["a",f,f,0,0,1,-f,f],["l",2*f-c,0],["a",f,f,0,0,1,-f,-f],["l",0,2*f-d],["a",f,f,0,0,1,f,-f],["z"] ];var g=[["M",a,b],["l",c,0],["l",0,d],["l",-c,0],["z"] ];return g.toString=e,g}function x(a,b,c,d,f){if(null==f&&null==d&&(d=c),a=+a,b=+b,c=+c,d=+d,null!=f)var g=Math.PI/180,h=a+c*Math.cos(-d*g),i=a+c*Math.cos(-f*g),j=b+c*Math.sin(-d*g),k=b+c*Math.sin(-f*g),l=[["M",h,j],["A",c,c,0,+(f-d>180),0,i,k] ];else l=[["M",a,b],["m",0,-d],["a",c,d,0,1,1,0,2*d],["a",c,d,0,1,1,0,-2*d],["z"] ];return l.toString=e,l}function y(b){var d=c(b),g=String.prototype.toLowerCase;if(d.rel)return f(d.rel);a.is(b,"array")&&a.is(b&&b[0],"array")||(b=a.parsePathString(b));var h=[],i=0,j=0,k=0,l=0,m=0;"M"==b[0][0]&&(i=b[0][1],j=b[0][2],k=i,l=j,m++,h.push(["M",i,j]));for(var n=m,o=b.length;o>n;n++){var p=h[n]=[],q=b[n];if(q[0]!=g.call(q[0]))switch(p[0]=g.call(q[0]),p[0]){case"a":p[1]=q[1],p[2]=q[2],p[3]=q[3],p[4]=q[4],p[5]=q[5],p[6]=+(q[6]-i).toFixed(3),p[7]=+(q[7]-j).toFixed(3);break;case"v":p[1]=+(q[1]-j).toFixed(3);break;case"m":k=q[1],l=q[2];default:for(var r=1,s=q.length;s>r;r++)p[r]=+(q[r]-(r%2?i:j)).toFixed(3)}else{p=h[n]=[],"m"==q[0]&&(k=q[1]+i,l=q[2]+j);for(var t=0,u=q.length;u>t;t++)h[n][t]=q[t]}var v=h[n].length;switch(h[n][0]){case"z":i=k,j=l;break;case"h":i+=+h[n][v-1];break;case"v":j+=+h[n][v-1];break;default:i+=+h[n][v-2],j+=+h[n][v-1]}}return h.toString=e,d.rel=f(h),h}function z(b){var d=c(b);if(d.abs)return f(d.abs);if(I(b,"array")&&I(b&&b[0],"array")||(b=a.parsePathString(b)),!b||!b.length)return[["M",0,0] ];var g,h=[],i=0,j=0,k=0,l=0,m=0;"M"==b[0][0]&&(i=+b[0][1],j=+b[0][2],k=i,l=j,m++,h[0]=["M",i,j]);for(var n,o,p=3==b.length&&"M"==b[0][0]&&"R"==b[1][0].toUpperCase()&&"Z"==b[2][0].toUpperCase(),q=m,r=b.length;r>q;q++){if(h.push(n=[]),o=b[q],g=o[0],g!=g.toUpperCase())switch(n[0]=g.toUpperCase(),n[0]){case"A":n[1]=o[1],n[2]=o[2],n[3]=o[3],n[4]=o[4],n[5]=o[5],n[6]=+o[6]+i,n[7]=+o[7]+j;break;case"V":n[1]=+o[1]+j;break;case"H":n[1]=+o[1]+i;break;case"R":for(var s=[i,j].concat(o.slice(1)),t=2,u=s.length;u>t;t++)s[t]=+s[t]+i,s[++t]=+s[t]+j;h.pop(),h=h.concat(G(s,p));break;case"O":h.pop(),s=x(i,j,o[1],o[2]),s.push(s[0]),h=h.concat(s);break;case"U":h.pop(),h=h.concat(x(i,j,o[1],o[2],o[3])),n=["U"].concat(h[h.length-1].slice(-2));break;case"M":k=+o[1]+i,l=+o[2]+j;default:for(t=1,u=o.length;u>t;t++)n[t]=+o[t]+(t%2?i:j)}else if("R"==g)s=[i,j].concat(o.slice(1)),h.pop(),h=h.concat(G(s,p)),n=["R"].concat(o.slice(-2));else if("O"==g)h.pop(),s=x(i,j,o[1],o[2]),s.push(s[0]),h=h.concat(s);else if("U"==g)h.pop(),h=h.concat(x(i,j,o[1],o[2],o[3])),n=["U"].concat(h[h.length-1].slice(-2));else for(var v=0,w=o.length;w>v;v++)n[v]=o[v];if(g=g.toUpperCase(),"O"!=g)switch(n[0]){case"Z":i=+k,j=+l;break;case"H":i=n[1];break;case"V":j=n[1];break;case"M":k=n[n.length-2],l=n[n.length-1];default:i=n[n.length-2],j=n[n.length-1]}}return h.toString=e,d.abs=f(h),h}function A(a,b,c,d){return[a,b,c,d,c,d]}function B(a,b,c,d,e,f){var g=1/3,h=2/3;return[g*a+h*c,g*b+h*d,g*e+h*c,g*f+h*d,e,f]}function C(b,c,d,e,f,g,h,i,j,k){var l,m=120*O/180,n=O/180*(+f||0),o=[],p=a._.cacher(function(a,b,c){var d=a*N.cos(c)-b*N.sin(c),e=a*N.sin(c)+b*N.cos(c);return{x:d,y:e}});if(k)y=k[0],z=k[1],w=k[2],x=k[3];else{l=p(b,c,-n),b=l.x,c=l.y,l=p(i,j,-n),i=l.x,j=l.y;var q=(N.cos(O/180*f),N.sin(O/180*f),(b-i)/2),r=(c-j)/2,s=q*q/(d*d)+r*r/(e*e);s>1&&(s=N.sqrt(s),d=s*d,e=s*e);var t=d*d,u=e*e,v=(g==h?-1:1)*N.sqrt(S((t*u-t*r*r-u*q*q)/(t*r*r+u*q*q))),w=v*d*r/e+(b+i)/2,x=v*-e*q/d+(c+j)/2,y=N.asin(((c-x)/e).toFixed(9)),z=N.asin(((j-x)/e).toFixed(9));y=w>b?O-y:y,z=w>i?O-z:z,0>y&&(y=2*O+y),0>z&&(z=2*O+z),h&&y>z&&(y-=2*O),!h&&z>y&&(z-=2*O)}var A=z-y;if(S(A)>m){var B=z,D=i,E=j;z=y+m*(h&&z>y?1:-1),i=w+d*N.cos(z),j=x+e*N.sin(z),o=C(i,j,d,e,f,0,h,D,E,[z,B,w,x])}A=z-y;var F=N.cos(y),G=N.sin(y),H=N.cos(z),I=N.sin(z),J=N.tan(A/4),K=4/3*d*J,L=4/3*e*J,M=[b,c],P=[b+K*G,c-L*F],Q=[i+K*I,j-L*H],R=[i,j];if(P[0]=2*M[0]-P[0],P[1]=2*M[1]-P[1],k)return[P,Q,R].concat(o);o=[P,Q,R].concat(o).join().split(",");for(var T=[],U=0,V=o.length;V>U;U++)T[U]=U%2?p(o[U-1],o[U],n).y:p(o[U],o[U+1],n).x;return T}function D(a,b,c,d,e,f,g,h){for(var i,j,k,l,m,n,o,p,q=[],r=[[],[] ],s=0;2>s;++s)if(0==s?(j=6*a-12*c+6*e,i=-3*a+9*c-9*e+3*g,k=3*c-3*a):(j=6*b-12*d+6*f,i=-3*b+9*d-9*f+3*h,k=3*d-3*b),S(i)<1e-12){if(S(j)<1e-12)continue;l=-k/j,l>0&&1>l&&q.push(l)}else o=j*j-4*k*i,p=N.sqrt(o),0>o||(m=(-j+p)/(2*i),m>0&&1>m&&q.push(m),n=(-j-p)/(2*i),n>0&&1>n&&q.push(n));for(var t,u=q.length,v=u;u--;)l=q[u],t=1-l,r[0][u]=t*t*t*a+3*t*t*l*c+3*t*l*l*e+l*l*l*g,r[1][u]=t*t*t*b+3*t*t*l*d+3*t*l*l*f+l*l*l*h;return r[0][v]=a,r[1][v]=b,r[0][v+1]=g,r[1][v+1]=h,r[0].length=r[1].length=v+2,{min:{x:P.apply(0,r[0]),y:P.apply(0,r[1])},max:{x:Q.apply(0,r[0]),y:Q.apply(0,r[1])}}}function E(a,b){var d=!b&&c(a);if(!b&&d.curve)return f(d.curve);for(var e=z(a),g=b&&z(b),h={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},j=(function(a,b,c){var d,e;if(!a)return["C",b.x,b.y,b.x,b.y,b.x,b.y];switch(!(a[0]in{T:1,Q:1})&&(b.qx=b.qy=null),a[0]){case"M":b.X=a[1],b.Y=a[2];break;case"A":a=["C"].concat(C.apply(0,[b.x,b.y].concat(a.slice(1))));break;case"S":"C"==c||"S"==c?(d=2*b.x-b.bx,e=2*b.y-b.by):(d=b.x,e=b.y),a=["C",d,e].concat(a.slice(1));break;case"T":"Q"==c||"T"==c?(b.qx=2*b.x-b.qx,b.qy=2*b.y-b.qy):(b.qx=b.x,b.qy=b.y),a=["C"].concat(B(b.x,b.y,b.qx,b.qy,a[1],a[2]));break;case"Q":b.qx=a[1],b.qy=a[2],a=["C"].concat(B(b.x,b.y,a[1],a[2],a[3],a[4]));break;case"L":a=["C"].concat(A(b.x,b.y,a[1],a[2]));break;case"H":a=["C"].concat(A(b.x,b.y,a[1],b.y));break;case"V":a=["C"].concat(A(b.x,b.y,b.x,a[1]));break;case"Z":a=["C"].concat(A(b.x,b.y,b.X,b.Y))}return a}),k=function(a,b){if(a[b].length>7){a[b].shift();for(var c=a[b];c.length;)m[b]="A",g&&(n[b]="A"),a.splice(b++,0,["C"].concat(c.splice(0,6)));a.splice(b,1),r=Q(e.length,g&&g.length||0)}},l=function(a,b,c,d,f){a&&b&&"M"==a[f][0]&&"M"!=b[f][0]&&(b.splice(f,0,["M",d.x,d.y]),c.bx=0,c.by=0,c.x=a[f][1],c.y=a[f][2],r=Q(e.length,g&&g.length||0))},m=[],n=[],o="",p="",q=0,r=Q(e.length,g&&g.length||0);r>q;q++){e[q]&&(o=e[q][0]),"C"!=o&&(m[q]=o,q&&(p=m[q-1])),e[q]=j(e[q],h,p),"A"!=m[q]&&"C"==o&&(m[q]="C"),k(e,q),g&&(g[q]&&(o=g[q][0]),"C"!=o&&(n[q]=o,q&&(p=n[q-1])),g[q]=j(g[q],i,p),"A"!=n[q]&&"C"==o&&(n[q]="C"),k(g,q)),l(e,g,h,i,q),l(g,e,i,h,q);var s=e[q],t=g&&g[q],u=s.length,v=g&&t.length;h.x=s[u-2],h.y=s[u-1],h.bx=M(s[u-4])||h.x,h.by=M(s[u-3])||h.y,i.bx=g&&(M(t[v-4])||i.x),i.by=g&&(M(t[v-3])||i.y),i.x=g&&t[v-2],i.y=g&&t[v-1]}return g||(d.curve=f(e)),g?[e,g]:e}function F(a,b){if(!b)return a;var c,d,e,f,g,h,i;for(a=E(a),e=0,g=a.length;g>e;e++)for(i=a[e],f=1,h=i.length;h>f;f+=2)c=b.x(i[f],i[f+1]),d=b.y(i[f],i[f+1]),i[f]=c,i[f+1]=d;return a}function G(a,b){for(var c=[],d=0,e=a.length;e-2*!b>d;d+=2){var f=[{x:+a[d-2],y:+a[d-1]},{x:+a[d],y:+a[d+1]},{x:+a[d+2],y:+a[d+3]},{x:+a[d+4],y:+a[d+5]}];b?d?e-4==d?f[3]={x:+a[0],y:+a[1]}:e-2==d&&(f[2]={x:+a[0],y:+a[1]},f[3]={x:+a[2],y:+a[3]}):f[0]={x:+a[e-2],y:+a[e-1]}:e-4==d?f[3]=f[2]:d||(f[0]={x:+a[d],y:+a[d+1]}),c.push(["C",(-f[0].x+6*f[1].x+f[2].x)/6,(-f[0].y+6*f[1].y+f[2].y)/6,(f[1].x+6*f[2].x-f[3].x)/6,(f[1].y+6*f[2].y-f[3].y)/6,f[2].x,f[2].y])}return c}var H=b.prototype,I=a.is,J=a._.clone,K="hasOwnProperty",L=/,?([a-z]),?/gi,M=parseFloat,N=Math,O=N.PI,P=N.min,Q=N.max,R=N.pow,S=N.abs,T=h(1),U=h(),V=h(0,1),W=a._unit2px,X={path:function(a){return a.attr("path")},circle:function(a){var b=W(a);return x(b.cx,b.cy,b.r)},ellipse:function(a){var b=W(a);return x(b.cx||0,b.cy||0,b.rx,b.ry)},rect:function(a){var b=W(a);return w(b.x||0,b.y||0,b.width,b.height,b.rx,b.ry)},image:function(a){var b=W(a);return w(b.x||0,b.y||0,b.width,b.height)},line:function(a){return"M"+[a.attr("x1")||0,a.attr("y1")||0,a.attr("x2"),a.attr("y2")]},polyline:function(a){return"M"+a.attr("points")},polygon:function(a){return"M"+a.attr("points")+"z"},deflt:function(a){var b=a.node.getBBox();return w(b.x,b.y,b.width,b.height)}};a.path=c,a.path.getTotalLength=T,a.path.getPointAtLength=U,a.path.getSubpath=function(a,b,c){if(this.getTotalLength(a)-c<1e-6)return V(a,b).end;var d=V(a,c,1);return b?V(d,b).end:d},H.getTotalLength=function(){return this.node.getTotalLength?this.node.getTotalLength():void 0},H.getPointAtLength=function(a){return U(this.attr("d"),a)},H.getSubpath=function(b,c){return a.path.getSubpath(this.attr("d"),b,c)},a._.box=d,a.path.findDotsAtSegment=i,a.path.bezierBBox=j,a.path.isPointInsideBBox=k,a.path.isBBoxIntersect=l,a.path.intersection=r,a.path.intersectionNumber=s,a.path.isPointInside=u,a.path.getBBox=v,a.path.get=X,a.path.toRelative=y,a.path.toAbsolute=z,a.path.toCubic=E,a.path.map=F,a.path.toString=e,a.path.clone=f}),d.plugin(function(a){var d=Math.max,e=Math.min,f=function(a){if(this.items=[],this.bindings={},this.length=0,this.type="set",a)for(var b=0,c=a.length;c>b;b++)a[b]&&(this[this.items.length]=this.items[this.items.length]=a[b],this.length++)},g=f.prototype;g.push=function(){for(var a,b,c=0,d=arguments.length;d>c;c++)a=arguments[c],a&&(b=this.items.length,this[b]=this.items[b]=a,this.length++);return this},g.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},g.forEach=function(a,b){for(var c=0,d=this.items.length;d>c;c++)if(a.call(b,this.items[c],c)===!1)return this;return this},g.animate=function(d,e,f,g){"function"!=typeof f||f.length||(g=f,f=c.linear),d instanceof a._.Animation&&(g=d.callback,f=d.easing,e=f.dur,d=d.attr);var h=arguments;if(a.is(d,"array")&&a.is(h[h.length-1],"array"))var i=!0;var j,k=function(){j?this.b=j:j=this.b},l=0,m=g&&function(){l++==this.length&&g.call(this)};return this.forEach(function(a,c){b.once("snap.animcreated."+a.id,k),i?h[c]&&a.animate.apply(a,h[c]):a.animate(d,e,f,m)})},g.remove=function(){for(;this.length;)this.pop().remove();return this},g.bind=function(a,b,c){var d={};if("function"==typeof b)this.bindings[a]=b;else{var e=c||a;this.bindings[a]=function(a){d[e]=a,b.attr(d)}}return this},g.attr=function(a){var b={};for(var c in a)this.bindings[c]?this.bindings[c](a[c]):b[c]=a[c];for(var d=0,e=this.items.length;e>d;d++)this.items[d].attr(b);return this},g.clear=function(){for(;this.length;)this.pop()},g.splice=function(a,b){a=0>a?d(this.length+a,0):a,b=d(0,e(this.length-a,b));var c,g=[],h=[],i=[];for(c=2;c<arguments.length;c++)i.push(arguments[c]);for(c=0;b>c;c++)h.push(this[a+c]);for(;c<this.length-a;c++)g.push(this[a+c]);var j=i.length;for(c=0;c<j+g.length;c++)this.items[a+c]=this[a+c]=j>c?i[c]:g[c-j];for(c=this.items.length=this.length-=b-j;this[c];)delete this[c++];return new f(h)},g.exclude=function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]==a)return this.splice(b,1),!0;return!1},g.insertAfter=function(a){for(var b=this.items.length;b--;)this.items[b].insertAfter(a);return this},g.getBBox=function(){for(var a=[],b=[],c=[],f=[],g=this.items.length;g--;)if(!this.items[g].removed){var h=this.items[g].getBBox();a.push(h.x),b.push(h.y),c.push(h.x+h.width),f.push(h.y+h.height)}return a=e.apply(0,a),b=e.apply(0,b),c=d.apply(0,c),f=d.apply(0,f),{x:a,y:b,x2:c,y2:f,width:c-a,height:f-b,cx:a+(c-a)/2,cy:b+(f-b)/2}},g.clone=function(a){a=new f;for(var b=0,c=this.items.length;c>b;b++)a.push(this.items[b].clone());return a},g.toString=function(){return"Snap‘s set"},g.type="set",a.set=function(){var a=new f;return arguments.length&&a.push.apply(a,Array.prototype.slice.call(arguments,0)),a}}),d.plugin(function(a,c){function d(a){var b=a[0];switch(b.toLowerCase()){case"t":return[b,0,0];case"m":return[b,1,0,0,1,0,0];case"r":return 4==a.length?[b,0,a[2],a[3] ]:[b,0];case"s":return 5==a.length?[b,1,1,a[3],a[4] ]:3==a.length?[b,1,1]:[b,1]}}function e(b,c,e){c=m(c).replace(/\.{3}|\u2026/g,b),b=a.parseTransformString(b)||[],c=a.parseTransformString(c)||[];for(var f,g,h,k,l=Math.max(b.length,c.length),n=[],o=[],p=0;l>p;p++){if(h=b[p]||d(c[p]),k=c[p]||d(h),h[0]!=k[0]||"r"==h[0].toLowerCase()&&(h[2]!=k[2]||h[3]!=k[3])||"s"==h[0].toLowerCase()&&(h[3]!=k[3]||h[4]!=k[4])){b=a._.transform2matrix(b,e()),c=a._.transform2matrix(c,e()),n=[["m",b.a,b.b,b.c,b.d,b.e,b.f] ],o=[["m",c.a,c.b,c.c,c.d,c.e,c.f] ];break}for(n[p]=[],o[p]=[],f=0,g=Math.max(h.length,k.length);g>f;f++)f in h&&(n[p][f]=h[f]),f in k&&(o[p][f]=k[f])}return{from:j(n),to:j(o),f:i(n)}}function f(a){return a}function g(a){return function(b){return+b.toFixed(3)+a}}function h(b){return a.rgb(b[0],b[1],b[2])}function i(a){var b,c,d,e,f,g,h=0,i=[];for(b=0,c=a.length;c>b;b++){for(f="[",g=['"'+a[b][0]+'"'],d=1,e=a[b].length;e>d;d++)g[d]="val["+h++ +"]";
f+=g+"]",i[b]=f}return Function("val","return Snap.path.toString.call(["+i+"])")}function j(a){for(var b=[],c=0,d=a.length;d>c;c++)for(var e=1,f=a[c].length;f>e;e++)b.push(a[c][e]);return b}var k={},l=/[a-z]+$/i,m=String;k.stroke=k.fill="colour",c.prototype.equal=function(a,c){return b("snap.util.equal",this,a,c).firstDefined()},b.on("snap.util.equal",function(b,c){var d,n,o=m(this.attr(b)||""),p=this;if(o==+o&&c==+c)return{from:+o,to:+c,f:f};if("colour"==k[b])return d=a.color(o),n=a.color(c),{from:[d.r,d.g,d.b,d.opacity],to:[n.r,n.g,n.b,n.opacity],f:h};if("transform"==b||"gradientTransform"==b||"patternTransform"==b)return c instanceof a.Matrix&&(c=c.toTransformString()),a._.rgTransform.test(c)||(c=a._.svgTransform2string(c)),e(o,c,function(){return p.getBBox(1)});if("d"==b||"path"==b)return d=a.path.toCubic(o,c),{from:j(d[0]),to:j(d[1]),f:i(d[0])};if("points"==b)return d=m(o).split(a._.separator),n=m(c).split(a._.separator),{from:d,to:n,f:function(a){return a}};aUnit=o.match(l);var q=m(c).match(l);return aUnit&&aUnit==q?{from:parseFloat(o),to:parseFloat(c),f:g(aUnit)}:{from:this.asPX(b),to:this.asPX(b,c),f:f}})}),d.plugin(function(a,c,d,e){for(var f=c.prototype,g="hasOwnProperty",h=("createTouch"in e.doc),i=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","touchstart","touchmove","touchend","touchcancel"],j={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},k=(function(a,b){var c="y"==a?"scrollTop":"scrollLeft",d=b&&b.node?b.node.ownerDocument:e.doc;return d[c in d.documentElement?"documentElement":"body"][c]}),l=function(){this.returnValue=!1},m=function(){return this.originalEvent.preventDefault()},n=function(){this.cancelBubble=!0},o=function(){return this.originalEvent.stopPropagation()},p=function(){return e.doc.addEventListener?function(a,b,c,d){var e=h&&j[b]?j[b]:b,f=function(e){var f=k("y",d),i=k("x",d);if(h&&j[g](b))for(var l=0,n=e.targetTouches&&e.targetTouches.length;n>l;l++)if(e.targetTouches[l].target==a||a.contains(e.targetTouches[l].target)){var p=e;e=e.targetTouches[l],e.originalEvent=p,e.preventDefault=m,e.stopPropagation=o;break}var q=e.clientX+i,r=e.clientY+f;return c.call(d,e,q,r)};return b!==e&&a.addEventListener(b,f,!1),a.addEventListener(e,f,!1),function(){return b!==e&&a.removeEventListener(b,f,!1),a.removeEventListener(e,f,!1),!0}}:e.doc.attachEvent?function(a,b,c,d){var e=function(a){a=a||d.node.ownerDocument.window.event;var b=k("y",d),e=k("x",d),f=a.clientX+e,g=a.clientY+b;return a.preventDefault=a.preventDefault||l,a.stopPropagation=a.stopPropagation||n,c.call(d,a,f,g)};a.attachEvent("on"+b,e);var f=function(){return a.detachEvent("on"+b,e),!0};return f}:void 0}(),q=[],r=function(a){for(var c,d=a.clientX,e=a.clientY,f=k("y"),g=k("x"),i=q.length;i--;){if(c=q[i],h){for(var j,l=a.touches&&a.touches.length;l--;)if(j=a.touches[l],j.identifier==c.el._drag.id||c.el.node.contains(j.target)){d=j.clientX,e=j.clientY,(a.originalEvent?a.originalEvent:a).preventDefault();break}}else a.preventDefault();{var m=c.el.node;m.nextSibling,m.parentNode,m.style.display}d+=g,e+=f,b("snap.drag.move."+c.el.id,c.move_scope||c.el,d-c.el._drag.x,e-c.el._drag.y,d,e,a)}},s=function(c){a.unmousemove(r).unmouseup(s);for(var d,e=q.length;e--;)d=q[e],d.el._drag={},b("snap.drag.end."+d.el.id,d.end_scope||d.start_scope||d.move_scope||d.el,c);q=[]},t=i.length;t--;)!function(b){a[b]=f[b]=function(c,d){return a.is(c,"function")&&(this.events=this.events||[],this.events.push({name:b,f:c,unbind:p(this.node||document,b,c,d||this)})),this},a["un"+b]=f["un"+b]=function(a){for(var c=this.events||[],d=c.length;d--;)if(c[d].name==b&&(c[d].f==a||!a))return c[d].unbind(),c.splice(d,1),!c.length&&delete this.events,this;return this}}(i[t]);f.hover=function(a,b,c,d){return this.mouseover(a,c).mouseout(b,d||c)},f.unhover=function(a,b){return this.unmouseover(a).unmouseout(b)};var u=[];f.drag=function(c,d,e,f,g,h){function i(i,j,k){(i.originalEvent||i).preventDefault(),this._drag.x=j,this._drag.y=k,this._drag.id=i.identifier,!q.length&&a.mousemove(r).mouseup(s),q.push({el:this,move_scope:f,start_scope:g,end_scope:h}),d&&b.on("snap.drag.start."+this.id,d),c&&b.on("snap.drag.move."+this.id,c),e&&b.on("snap.drag.end."+this.id,e),b("snap.drag.start."+this.id,g||f||this,j,k,i)}if(!arguments.length){var j;return this.drag(function(a,b){this.attr({transform:j+(j?"T":"t")+[a,b]})},function(){j=this.transform().local})}return this._drag={},u.push({el:this,start:i}),this.mousedown(i),this},f.undrag=function(){for(var c=u.length;c--;)u[c].el==this&&(this.unmousedown(u[c].start),u.splice(c,1),b.unbind("snap.drag.*."+this.id));return!u.length&&a.unmousemove(r).unmouseup(s),this}}),d.plugin(function(a,c,d){var e=(c.prototype,d.prototype),f=/^\s*url\((.+)\)/,g=String,h=a._.$;a.filter={},e.filter=function(b){var d=this;"svg"!=d.type&&(d=d.paper);var e=a.parse(g(b)),f=a._.id(),i=(d.node.offsetWidth,d.node.offsetHeight,h("filter"));return h(i,{id:f,filterUnits:"userSpaceOnUse"}),i.appendChild(e.node),d.defs.appendChild(i),new c(i)},b.on("snap.util.getattr.filter",function(){b.stop();var c=h(this.node,"filter");if(c){var d=g(c).match(f);return d&&a.select(d[1])}}),b.on("snap.util.attr.filter",function(d){if(d instanceof c&&"filter"==d.type){b.stop();var e=d.node.id;e||(h(d.node,{id:d.id}),e=d.id),h(this.node,{filter:a.url(e)})}d&&"none"!=d||(b.stop(),this.node.removeAttribute("filter"))}),a.filter.blur=function(b,c){null==b&&(b=2);var d=null==c?b:[b,c];return a.format('<feGaussianBlur stdDeviation="{def}"/>',{def:d})},a.filter.blur.toString=function(){return this()},a.filter.shadow=function(b,c,d,e,f){return"string"==typeof d&&(e=d,f=e,d=4),"string"!=typeof e&&(f=e,e="#000"),e=e||"#000",null==d&&(d=4),null==f&&(f=1),null==b&&(b=0,c=2),null==c&&(c=b),e=a.color(e),a.format('<feGaussianBlur in="SourceAlpha" stdDeviation="{blur}"/><feOffset dx="{dx}" dy="{dy}" result="offsetblur"/><feFlood flood-color="{color}"/><feComposite in2="offsetblur" operator="in"/><feComponentTransfer><feFuncA type="linear" slope="{opacity}"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>',{color:e,dx:b,dy:c,blur:d,opacity:f})},a.filter.shadow.toString=function(){return this()},a.filter.grayscale=function(b){return null==b&&(b=1),a.format('<feColorMatrix type="matrix" values="{a} {b} {c} 0 0 {d} {e} {f} 0 0 {g} {b} {h} 0 0 0 0 0 1 0"/>',{a:.2126+.7874*(1-b),b:.7152-.7152*(1-b),c:.0722-.0722*(1-b),d:.2126-.2126*(1-b),e:.7152+.2848*(1-b),f:.0722-.0722*(1-b),g:.2126-.2126*(1-b),h:.0722+.9278*(1-b)})},a.filter.grayscale.toString=function(){return this()},a.filter.sepia=function(b){return null==b&&(b=1),a.format('<feColorMatrix type="matrix" values="{a} {b} {c} 0 0 {d} {e} {f} 0 0 {g} {h} {i} 0 0 0 0 0 1 0"/>',{a:.393+.607*(1-b),b:.769-.769*(1-b),c:.189-.189*(1-b),d:.349-.349*(1-b),e:.686+.314*(1-b),f:.168-.168*(1-b),g:.272-.272*(1-b),h:.534-.534*(1-b),i:.131+.869*(1-b)})},a.filter.sepia.toString=function(){return this()},a.filter.saturate=function(b){return null==b&&(b=1),a.format('<feColorMatrix type="saturate" values="{amount}"/>',{amount:1-b})},a.filter.saturate.toString=function(){return this()},a.filter.hueRotate=function(b){return b=b||0,a.format('<feColorMatrix type="hueRotate" values="{angle}"/>',{angle:b})},a.filter.hueRotate.toString=function(){return this()},a.filter.invert=function(b){return null==b&&(b=1),a.format('<feComponentTransfer><feFuncR type="table" tableValues="{amount} {amount2}"/><feFuncG type="table" tableValues="{amount} {amount2}"/><feFuncB type="table" tableValues="{amount} {amount2}"/></feComponentTransfer>',{amount:b,amount2:1-b})},a.filter.invert.toString=function(){return this()},a.filter.brightness=function(b){return null==b&&(b=1),a.format('<feComponentTransfer><feFuncR type="linear" slope="{amount}"/><feFuncG type="linear" slope="{amount}"/><feFuncB type="linear" slope="{amount}"/></feComponentTransfer>',{amount:b})},a.filter.brightness.toString=function(){return this()},a.filter.contrast=function(b){return null==b&&(b=1),a.format('<feComponentTransfer><feFuncR type="linear" slope="{amount}" intercept="{amount2}"/><feFuncG type="linear" slope="{amount}" intercept="{amount2}"/><feFuncB type="linear" slope="{amount}" intercept="{amount2}"/></feComponentTransfer>',{amount:b,amount2:.5-b/2})},a.filter.contrast.toString=function(){return this()}}),d});
]]></script>
<script><![CDATA[
(function (glob, factory) {
    if (typeof define === 'function' && define.amd) {
        define('ProfileSVG', ['ProfileSVG/snap.svg'], function (Snap) {
            return factory(Snap);
        });
    } else {
        glob.ProfileSVG = factory(glob.Snap);
    }
}(this, function (Snap) {
    'use strict';

    var supportsPassive = false;
    try {
        var opts = Object.defineProperty({}, 'passive', {
            get: function () {
                return supportsPassive = true;
            }
        });
        window.addEventListener("testPassive", null, opts);
        window.removeEventListener("testPassive", null, opts);
    } catch (e) { // not supported
    }

    var stopper = function (e) {
        e.preventDefault();
        e.stopPropagation();
    };

    var throttle = function (delay, filter, callback) {
        var previousCall = new Date().getTime();
        return function (e) {
            var time = new Date().getTime();
            if ((time - previousCall) >= delay) {
                previousCall = time;
                callback.apply(null, arguments);
            }
            filter(e);
        };
    };


    var ProfileSVG = {};

    var NS_SVG = 'http://www.w3.org/2000/svg';
    var DEFAULT_TRANSITION_TIME = 300;
    var ZOOM_STEP = 1.4;
    var VIEWPORT_SCALE = 0.9;
    var VIEWPORT_MARGIN_X = 20;

    var formatText = function (fig, text, availableWidth) {
        if (availableWidth < 3 * fig.charWidthM) {
            return '';
        }
        var w = availableWidth;
        var m = fig.charWidthM;
        var n = fig.charWidthN;
        var m2 = m * m;
        var n2 = n * n;
        var nc = 0.5 / n2 * (
            (n - m) * Math.sqrt(n2 + (4 * w - 2 * m) * n + m2) + n2 + 2 * (w - m) * n + m2);
        var nchars = Math.ceil(nc);
        if (text.length <= nchars) {
            return text;
        }
        return text.slice(0, nchars - 2) + '..';
    };

    var isDarkColor = function (c) {
        var m = c.match(/^rgba?\(\s*(\d+)[\s,]+(\d+)[\s,]+(\d+)/);
        if (m) {
            return m[1] * 299 + m[2] * 587 + m[3] * 114 < 255 * 650;
        }
        m = c.match(/^#([\dA-F]{2})([\dA-F]{2})([\dA-F]{2})/i);
        if (m) {
            var r = parseInt(m[1], 16);
            var g = parseInt(m[2], 16);
            var b = parseInt(m[3], 16);
            return r * 299 + g * 587 + b * 114 < 255 * 650;
        }
        return true;
    };

    ProfileSVG.moveAndZoom = function (targetFocusX, targetScaleX, fig, deltaT) {
        if (typeof deltaT === 'undefined') {
            deltaT = DEFAULT_TRANSITION_TIME;
        }

        var targetFocusY = fig.cy;
        var targetScaleY = 1;

        // TODO: dynamically update the transformation while dragging
        var mat = fig.viewport.node.transform.baseVal.consolidate().matrix;

        var oldScaleX = mat.a;
        var oldScaleY = mat.d;
        var oldE = mat.e;
        var oldF = mat.f;

        var targetE = fig.cx - targetScaleX * targetFocusX;
        var targetF = fig.cy - targetScaleY * targetFocusY;

        fig.focusX = targetFocusX;
        fig.focusY = targetFocusY;
        fig.scaleX = targetScaleX;
        fig.scaleY = targetScaleY;

        var rects = undefined;
        var pathrects = undefined;
        if (fig.roundradius > 0) {
            rects = fig.viewport.selectAll('rect');
        } else {
            pathrects = fig.viewport.selectAll('path');
        }

        var scaleViewport = function (step) {
            var scaleX = oldScaleX + (targetScaleX - oldScaleX) * step;
            var scaleY = oldScaleY + (targetScaleY - oldScaleY) * step;

            var rMatrix = fig.viewport.node.transform.baseVal.consolidate().matrix;
            rMatrix.a = scaleX;
            rMatrix.d = scaleY;
            rMatrix.e = oldE + (targetE - oldE) * step; // TransX
            rMatrix.f = oldF + (targetF - oldF) * step; // TransY

            if (rects) {
                rects.forEach(function (r) {
                    var rect = r.node;
                    rect.setAttribute('rx', Math.max(0.0, fig.roundradius / scaleX));
                    rect.setAttribute('ry', Math.max(0.0, fig.roundradius / scaleY));
                });
            }
        };

        var finish = function () {
            scaleViewport(1);
            var scaleXt = 1.0 / targetScaleX;
            var scaleYt = 1.0 / targetScaleY;
            var updateText = function (text, x, y, w, shortinfo) {
                var tMatrix = text.transform.baseVal.getItem(0).matrix;
                tMatrix.a = scaleXt;
                tMatrix.d = scaleYt;
                tMatrix.e = (1.0 - scaleXt) * x;
                tMatrix.f = (1.0 - scaleYt) * y;

                text.firstChild.nodeValue = formatText(fig, shortinfo, w / scaleXt);
                text.style.display = 'inherit';
            };
            if (rects) {
                rects.forEach(function (r) {
                    var rect = r.node;
                    var x = rect.x.baseVal.value;
                    var y = rect.y.baseVal.value;
                    var w = rect.width.baseVal.value;
                    var shortinfo = rect.getAttribute('data-shortinfo');
                    updateText(rect.nextElementSibling, x, y, w, shortinfo);
                });
            }
            if (pathrects) {
                pathrects.forEach(function (p) {
                    var path = p.node;
                    // The API compatibility of path segments is problematic.
                    var d = path.getAttribute('d');
                    var values = d.match(/^M\s*([\d.]+)[\s,]+(-?[\d.]+)[^h]+h\s*([\d.]+)/);
                    var x = Number(values[1]);
                    var y = Number(values[2]);
                    var w = Number(values[3]);
                    var shortinfo = path.getAttribute('data-shortinfo');
                    updateText(path.nextElementSibling, x, y, w, shortinfo);
                });
            }
        };

        if (deltaT != 0) {
            if (!fig.notext) {
                fig.viewport.selectAll('text').forEach(function (text) {
                    text.node.style.display = 'none';
                });
            }
            Snap.animate(0, 1, scaleViewport, deltaT, null, fig.notext ? null : finish);
        } else {
            if (!fig.notext) {
                finish();
            }
        }

    };

    ProfileSVG.reset = function (fig) {
        var w = fig.width - VIEWPORT_MARGIN_X;
        var targetScaleX = fig.width / w * VIEWPORT_SCALE;
        ProfileSVG.moveAndZoom(fig.cx, targetScaleX, fig);
    };

    ProfileSVG.initialize = function (figId) {

        var svg = Snap.select('#' + figId);
        var fig = {};
        fig.id = figId;

        var bg = svg.select('#' + figId + '-bg');
        var bbox = bg.getBBox();
        fig.width = bbox.width;
        fig.height = bbox.height;
        fig.cx = fig.width / 2;
        fig.cy = fig.height / 2;

        fig.viewport = svg.select('#' + figId + '-viewport');

        fig.xstep = fig.viewport.node.getAttribute('data-xstep');
        fig.tunit = fig.viewport.node.getAttribute('data-tunit');
        fig.delay = fig.viewport.node.getAttribute('data-delay');

        var texts = fig.viewport.selectAll('text');
        fig.notext = false;
        if (texts[0]) {
            fig.notext = getComputedStyle(texts[0].node).strokeOpacity == 0.0;
            texts.forEach(function (text) {
                text.node.style.display = 'none';
            });
        }
        texts = null;

        fig.roundradius = 0.0;
        var rect = fig.viewport.select('rect');
        if (rect) {
            fig.roundradius = rect.node.rx.baseVal.value;
        }

        fig.scaleX = 1.0;
        fig.scaleY = 1.0; // prepare for the future
        fig.focusX = fig.cx; // center x in the raw (scaleX=1) coordinate space
        fig.focusY = fig.cy; // center y in the raw (scaleY=1) coordinate space

        var textBg = document.createElementNS(NS_SVG, 'rect');
        var detail = document.createElementNS(NS_SVG, 'text');
        var time = document.createElementNS(NS_SVG, 'text');
        detail.style.visibility = 'hidden';
        detail.textContent = 'MOw';
        fig.viewport.node.parentNode.appendChild(textBg);
        fig.viewport.node.parentNode.appendChild(detail);
        fig.viewport.node.parentNode.appendChild(time);
        var mBBox = detail.getBBox();
        fig.charWidthM = mBBox.width / 3;
        detail.textContent = 'night';
        var nBBox = detail.getBBox();
        fig.charWidthN = nBBox.width / 5;
        fig.textHeight = nBBox.height;
        detail.style.display = 'none';
        detail.style.visibility = 'visible';

        detail.setAttribute('id', figId + '-details');
        detail.setAttribute('x', fig.charWidthM);
        detail.setAttribute('y', fig.height - fig.textHeight * 0.75);

        time.setAttribute('x', fig.width - fig.charWidthM * 10);
        time.setAttribute('y', fig.height - fig.textHeight * 0.75);

        textBg.setAttribute('x', 0);
        textBg.setAttribute('y', fig.height - fig.textHeight * 2);
        textBg.setAttribute('width', fig.width);
        textBg.setAttribute('height', fig.textHeight * 2);
        var textBgFill = getComputedStyle(textBg).fill;
        if (textBgFill == "rgba(0, 0, 0, 0)" || textBgFill == "transparent") {
            var isDark = isDarkColor(getComputedStyle(detail).fill);
            textBg.style.fill = isDark ? 'white' : 'black';
        }
        textBg.style.display = 'none';

        ProfileSVG.reset(fig);

        var rectDblClickHandler = function (e) {
            var bbox = e.target.getBBox();
            var cx = bbox.x + bbox.width / 2;
            var targetScaleX = fig.width / bbox.width * VIEWPORT_SCALE;
            ProfileSVG.moveAndZoom(cx, targetScaleX, fig);
        };

        var rectMouseOverHandler = function (e) {
            var rect = e.target;
            var text = rect.nextElementSibling;
            var details = document.getElementById(fig.id + '-details');
            text.style.strokeWidth = '1';
            var sinfo = rect.getAttribute('data-shortinfo');
            var dir = rect.getAttribute('data-dinfo');
            var i = sinfo.indexOf(' in ');
            var func = sinfo.slice(0, i + 4);
            var file = sinfo.slice(i + 4);
            var time = details.nextElementSibling;
            details.textContent = 'Function: ' + func + dir + file;
            details.style.display = 'inherit';
            if (fig.delay) {
                var count = Math.round(rect.width.baseVal.value / fig.xstep);
                var t = count * (fig.tunit === 's' ? fig.delay :
                    fig.tunit === 'ms' ? fig.delay * 1e3 :
                        fig.tunit === 'us' || fig.tunit === 'μs' ? fig.delay * 1e6 : 1);
                var tp = Math.round(t * 1000) / 1000;
                time.textContent = 'Time: ' + tp + ' ' + fig.tunit;
                time.style.display = 'inherit';
            }
            details.previousElementSibling.style.display = 'inherit';
        };
        var rectMouseOutHandler = function (e) {
            var rect = e.target;
            var text = rect.nextElementSibling;
            var details = document.getElementById(fig.id + '-details');
            text.style.strokeWidth = '0';
            details.style.display = 'none';
            details.previousElementSibling.style.display = 'none';
            details.nextElementSibling.style.display = 'none';
        };

        var rects = fig.viewport.selectAll(fig.roundradius > 0 ? 'rect' : 'path');
        rects.forEach(function (r) {
            var rect = r.node;
            var text = rect.nextElementSibling;
            rect.setAttribute('data-shortinfo', text.textContent);
            var dir = rect.getAttribute('data-dinfo');
            rect.setAttribute('data-dinfo', dir);
            rect.addEventListener('dblclick', rectDblClickHandler, false);
            rect.addEventListener('mouseover', rectMouseOverHandler, false);
            rect.addEventListener('mouseout', rectMouseOutHandler, false);
            var transform = svg.node.createSVGTransform();
            text.transform.baseVal.initialize(transform); // matrix(1, 0, 0, 1, 0, 0)
        });
        rects = null;

        bg.dblclick(function () {
            ProfileSVG.reset(fig);
        });

        var mouseWheelHandler = throttle(400, stopper, function (e) {
            var delta = Math.round(e.deltaY * 100);
            if (delta == 0) {
                return;
            }
            var scale = delta < 0 ? ZOOM_STEP : 1 / ZOOM_STEP;

            var clientRect = svg.node.getBoundingClientRect();
            var mx = e.clientX - clientRect.left;
            //var my = e.clientY - clientRect.top;
            var ctm = svg.node.getCTM();
            var x = ctm ? (mx - ctm.e) / ctm.a : mx;
            //var y = ctm ? (my - ctm.f) / ctm.d : my;
            var px = (x - fig.cx) / fig.scaleX + fig.focusX;
            var targetScaleX = Math.max(fig.scaleX * scale, 0.01);
            var targetFocusX = fig.scaleX / targetScaleX * (fig.focusX - px) + px;
            ProfileSVG.moveAndZoom(targetFocusX, targetScaleX, fig, 400);
        });

        svg.node.addEventListener('wheel', mouseWheelHandler, supportsPassive ? {
            passive: false
        } : false);

        fig.viewport.drag();
    };

    return ProfileSVG;
}));

]]></script>
<script><![CDATA[
if (typeof require === 'function' && define.amd) {
    require(['ProfileSVG'], function (ProfileSVG) {
        ProfileSVG.initialize("fig-c9d3cdc6eebe4ecc91a3469103c96226");
    });
} else {
    ProfileSVG.initialize("fig-c9d3cdc6eebe4ecc91a3469103c96226");
}
]]></script>
</svg>
</body>
</html>
</div></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "sdsu-comp526/fall25",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "julia-1.10"
        },
        kernelOptions: {
            name: "julia-1.10",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'julia-1.10'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="module5-3_householder.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">18) Householder QR</p>
      </div>
    </a>
    <a class="right-next"
       href="module5-5_solving_systems.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">20) Solving Systems</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#last-time">Last time</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#today">Today</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-on-householder-qr">1. Recap on Householder QR</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#householder-an-improved-algorithm">Householder: An improved algorithm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#householder-is-backward-stable">Householder is backward stable</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#orthogonality-is-preserved">Orthogonality is preserved</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#composition-of-reflectors">2. Composition of reflectors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#this-works-even-for-very-nonsquare-matrices">This works even for very nonsquare matrices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-to-python-s-numpy-linalg-qr">Compare to Python’s <code class="docutils literal notranslate"><span class="pre">numpy.linalg.qr</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cholesky-decomposition">3. Cholesky decomposition</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#can-we-fix-this">Can we fix this?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-fast-are-these-methods">How fast are these methods?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#profiling">4. Profiling</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Valeria Barra
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>